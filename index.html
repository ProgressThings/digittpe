<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProgiCheck by Progress Things — Diagnostic Maturité Numérique</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        :root{--primary:#1a1a1a;--secondary:#2d2d2d;--accent:#00D4AA;--accent-dark:#00B894;--white:#fff;--gray-100:#f7f7f7;--gray-200:#e5e5e5;--gray-300:#d4d4d4;--gray-400:#a3a3a3;--gray-500:#737373;--danger:#ef4444;--warning:#f59e0b;--success:#10b981}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Inter',sans-serif;background:var(--gray-100);color:var(--primary);line-height:1.6}
        .icon{display:inline-flex;align-items:center;justify-content:center;width:44px;height:44px;border-radius:12px}
        .icon svg{width:22px;height:22px}
        .icon-accent{background:var(--accent);color:var(--primary)}
        .icon-accent svg{fill:var(--primary)}
        .icon-success{background:rgba(16,185,129,.12)}
        .icon-success svg{fill:var(--success)}
        .icon-warning{background:rgba(245,158,11,.12)}
        .icon-warning svg{fill:var(--warning)}
        .icon-danger{background:rgba(239,68,68,.12)}
        .icon-danger svg{fill:var(--danger)}
        .icon-blue{background:rgba(59,130,246,.15)}
        .icon-blue svg{fill:#3b82f6}
        .icon-purple{background:rgba(139,92,246,.15)}
        .icon-purple svg{fill:#8b5cf6}
        .modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;display:flex;align-items:center;justify-content:center;padding:1rem}
        .modal-overlay.hidden{display:none}
        .modal{background:var(--white);border-radius:20px;max-width:520px;width:100%;padding:2rem;animation:fadeIn .3s}
        .modal h2{font-family:'Space Grotesk',sans-serif;font-size:1.4rem;margin-bottom:1rem;text-align:center;display:flex;align-items:center;justify-content:center;gap:.5rem}
        .modal h2 svg{width:24px;height:24px;fill:var(--accent)}
        .modal ul{color:var(--gray-500);font-size:.85rem;margin:1rem 0 1rem 1.5rem}
        .modal ul li{margin-bottom:.5rem}
        .modal-checkbox{display:flex;align-items:flex-start;gap:.75rem;margin:1.5rem 0;padding:1rem;background:var(--gray-100);border-radius:10px}
        .modal-checkbox input{width:20px;height:20px;accent-color:var(--accent);cursor:pointer}
        .modal-checkbox label{font-size:.85rem;color:var(--gray-500);cursor:pointer}
        .modal-btn{width:100%;padding:1rem;border-radius:50px;font-size:1rem;font-weight:600;cursor:pointer;border:none;transition:all .3s}
        .modal-btn:disabled{background:var(--gray-300);color:var(--gray-500);cursor:not-allowed}
        .modal-btn:not(:disabled){background:var(--accent);color:var(--primary)}
        header{background:var(--primary);padding:1rem 2rem;position:fixed;top:0;left:0;right:0;z-index:1000;display:flex;justify-content:space-between;align-items:center}
        .logo{display:flex;align-items:center;gap:.75rem}
        .logo-icon{width:40px;height:40px}
        .logo-text{color:var(--white);font-family:'Space Grotesk',sans-serif;font-weight:700;font-size:1.25rem}
        .logo-text span{color:var(--accent)}
        .header-pt{color:var(--gray-400);font-size:.8rem;text-decoration:none}
        .header-pt strong{color:var(--accent)}
        main{margin-top:72px}
        .container{max-width:900px;margin:0 auto;padding:2rem 1rem}
        .section{display:none;animation:fadeIn .4s}
        .section.active{display:block}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .hero{text-align:center;padding:3rem 1rem}
        .hero-badge{display:inline-flex;align-items:center;gap:.5rem;background:var(--accent);color:var(--primary);padding:.5rem 1rem;border-radius:50px;font-size:.875rem;font-weight:600;margin-bottom:1.5rem}
        .hero-badge svg{width:16px;height:16px;fill:var(--primary)}
        .hero h1{font-family:'Space Grotesk',sans-serif;font-size:2.5rem;font-weight:700;line-height:1.2;margin-bottom:1rem}
        .hero h1 span{color:var(--accent-dark)}
        .hero-subtitle{font-size:1.1rem;color:var(--gray-500);max-width:600px;margin:0 auto 2rem}
        .hero-cta{display:inline-flex;align-items:center;gap:.75rem;background:var(--primary);color:var(--white);padding:1rem 2rem;border-radius:50px;font-size:1.1rem;font-weight:600;cursor:pointer;border:none;transition:all .3s}
        .hero-cta:hover{background:var(--secondary);transform:translateY(-2px)}
        .hero-cta svg{width:20px;height:20px;fill:var(--white)}
        .free-badge{display:inline-flex;align-items:center;gap:.4rem;background:var(--success);color:var(--white);padding:.25rem .75rem;border-radius:50px;font-size:.75rem;font-weight:600;margin-top:1rem}
        .free-badge svg{width:14px;height:14px;fill:var(--white)}
        .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-top:3rem}
        .feature-card{background:var(--white);padding:1.5rem;border-radius:16px;border:1px solid var(--gray-200);text-align:center}
        .feature-card .icon{margin:0 auto .75rem}
        .feature-card h3{font-family:'Space Grotesk',sans-serif;font-size:1rem;font-weight:600}
        .feature-card p{color:var(--gray-500);font-size:.85rem}
        .dic-banner{background:linear-gradient(135deg,var(--primary),var(--secondary));padding:2rem;border-radius:20px;margin-top:2rem;color:var(--white)}
        .dic-banner h3{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;margin-bottom:1rem;text-align:center;display:flex;align-items:center;justify-content:center;gap:.5rem}
        .dic-banner h3 svg{width:24px;height:24px;fill:var(--accent)}
        .dic-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
        @media(max-width:600px){.dic-grid{grid-template-columns:1fr}}
        .dic-item{text-align:center;padding:1rem;background:rgba(255,255,255,.05);border-radius:12px}
        .dic-item .icon{margin:0 auto .5rem;width:36px;height:36px}
        .dic-item .icon svg{width:18px;height:18px}
        .dic-item h4{color:var(--accent);font-size:.9rem}
        .dic-item p{font-size:.75rem;color:var(--gray-400)}
        .pt-banner{background:var(--accent);padding:1.5rem;border-radius:16px;margin-top:2rem;text-align:center;color:var(--primary)}
        .pt-banner p{font-weight:500}
        .pt-banner .tagline{font-weight:700}
        .form-section{max-width:500px;margin:0 auto}
        .form-header{text-align:center;margin-bottom:2rem}
        .form-header h2{font-family:'Space Grotesk',sans-serif;font-size:1.75rem;display:flex;align-items:center;justify-content:center;gap:.5rem}
        .form-header h2 svg{width:28px;height:28px;fill:var(--accent)}
        .form-card{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200)}
        .form-group{margin-bottom:1.25rem}
        .form-group label{display:block;font-weight:500;margin-bottom:.5rem;font-size:.875rem}
        .form-group .required{color:var(--danger)}
        .form-group input,.form-group select{width:100%;padding:.875rem;border:1px solid var(--gray-300);border-radius:10px;font-size:1rem}
        .form-group input:focus,.form-group select:focus{outline:none;border-color:var(--accent)}
        .quiz-header{text-align:center;margin-bottom:2rem}
        .quiz-header h2{font-family:'Space Grotesk',sans-serif;font-size:1.5rem}
        .progress-container{background:var(--gray-200);height:8px;border-radius:4px;overflow:hidden;margin-bottom:.5rem}
        .progress-bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-dark));transition:width .4s}
        .progress-text{font-size:.875rem;color:var(--gray-500)}
        .category-indicator{display:inline-flex;align-items:center;gap:.5rem;background:var(--primary);color:var(--white);padding:.5rem 1rem;border-radius:50px;font-size:.875rem;margin-bottom:1.5rem}
        .category-indicator svg{width:18px;height:18px;fill:var(--accent)}
        .question-card{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200)}
        .question-dic{display:inline-flex;align-items:center;gap:.4rem;font-size:.75rem;padding:.35rem .75rem;border-radius:6px;margin-bottom:.75rem;background:var(--gray-100);color:var(--gray-500)}
        .question-dic svg{width:14px;height:14px;fill:var(--gray-500)}
        .question-text{font-family:'Space Grotesk',sans-serif;font-size:1.2rem;font-weight:600;margin-bottom:1.5rem}
        .options{display:flex;flex-direction:column;gap:.75rem}
        .option{display:flex;align-items:center;padding:1rem;border:2px solid var(--gray-200);border-radius:12px;cursor:pointer;transition:all .2s}
        .option:hover{border-color:var(--accent);background:rgba(0,212,170,.05)}
        .option.selected{border-color:var(--accent);background:rgba(0,212,170,.1)}
        .option-radio{width:20px;height:20px;border:2px solid var(--gray-300);border-radius:50%;margin-right:1rem;display:flex;align-items:center;justify-content:center}
        .option.selected .option-radio{border-color:var(--accent);background:var(--accent)}
        .option.selected .option-radio::after{content:'';width:8px;height:8px;background:var(--white);border-radius:50%}
        .option-text{font-size:.9rem}
        .nav-buttons{display:flex;justify-content:space-between;margin-top:2rem;gap:1rem}
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.875rem 1.5rem;border-radius:50px;font-size:1rem;font-weight:600;cursor:pointer;border:none;text-decoration:none}
        .btn svg{width:18px;height:18px}
        .btn-primary{background:var(--primary);color:var(--white)}
        .btn-primary svg{fill:var(--white)}
        .btn-primary:hover{background:var(--secondary)}
        .btn-primary:disabled{background:var(--gray-300);cursor:not-allowed}
        .btn-secondary{background:var(--white);color:var(--primary);border:1px solid var(--gray-300)}
        .btn-secondary svg{fill:var(--primary)}
        .btn-accent{background:var(--accent);color:var(--primary)}
        .btn-accent svg{fill:var(--primary)}
        .results-header{text-align:center;margin-bottom:2rem}
        .results-header h2{font-family:'Space Grotesk',sans-serif;font-size:2rem;display:flex;align-items:center;justify-content:center;gap:.5rem}
        .results-header h2 svg{width:32px;height:32px;fill:var(--success)}
        .score-display{background:var(--primary);color:var(--white);padding:2.5rem 2rem;border-radius:24px;text-align:center;margin-bottom:2rem}
        .score-circle{width:150px;height:150px;border-radius:50%;background:conic-gradient(var(--accent) calc(var(--score) * 1%),var(--secondary) 0);display:flex;align-items:center;justify-content:center;margin:0 auto 1.5rem;position:relative}
        .score-circle::before{content:'';position:absolute;width:120px;height:120px;background:var(--primary);border-radius:50%}
        .score-value{position:relative;z-index:1;font-family:'Space Grotesk',sans-serif;font-size:2.5rem;font-weight:700}
        .score-value span{font-size:1.25rem;color:var(--gray-400)}
        .score-label{font-size:1.25rem;font-weight:600}
        .score-description{color:var(--gray-400);font-size:.9rem}
        .dic-scores{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid var(--secondary)}
        .dic-score-item{text-align:center}
        .dic-score-item .label{font-size:.7rem;color:var(--gray-400);display:flex;align-items:center;justify-content:center;gap:.25rem}
        .dic-score-item .label svg{width:12px;height:12px;fill:var(--gray-400)}
        .dic-score-item .value{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;font-weight:700;color:var(--accent)}
        .chart-container{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200);margin-bottom:2rem}
        .chart-container h3{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;margin-bottom:1.5rem;text-align:center;display:flex;align-items:center;justify-content:center;gap:.5rem}
        .chart-container h3 svg{width:24px;height:24px;fill:var(--accent)}
        #radarChart{max-height:320px}
        .category-scores{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem;margin-bottom:2rem}
        .category-score-card{background:var(--white);padding:1.25rem;border-radius:16px;border:1px solid var(--gray-200)}
        .category-score-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}
        .category-score-name{font-weight:600;font-size:.9rem;display:flex;align-items:center;gap:.5rem}
        .category-score-name svg{width:18px;height:18px}
        .category-score-value{font-family:'Space Grotesk',sans-serif;font-weight:700;font-size:1.1rem}
        .category-score-value.low{color:var(--danger)}
        .category-score-value.medium{color:var(--warning)}
        .category-score-value.high{color:var(--success)}
        .category-score-bar{height:8px;background:var(--gray-200);border-radius:4px;overflow:hidden;margin-bottom:.5rem}
        .category-score-fill{height:100%;border-radius:4px}
        .category-score-fill.low{background:var(--danger)}
        .category-score-fill.medium{background:var(--warning)}
        .category-score-fill.high{background:var(--success)}
        .category-score-desc{font-size:.75rem;color:var(--gray-500)}
        .download-section{display:flex;justify-content:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}
        .solutions-section{background:linear-gradient(135deg,#1a1a1a,#2d2d2d);padding:2rem;border-radius:20px;margin-bottom:2rem;color:var(--white)}
        .solutions-section h3{font-family:'Space Grotesk',sans-serif;font-size:1.2rem;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}
        .solutions-section h3 svg{width:24px;height:24px;fill:var(--accent)}
        .solution-card{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:1.25rem;margin-bottom:1rem;display:flex;align-items:center;gap:1rem}
        .solution-icon{width:40px;height:40px;background:var(--accent);border-radius:10px;display:flex;align-items:center;justify-content:center}
        .solution-icon svg{width:20px;height:20px;fill:var(--primary)}
        .solution-content h4{font-weight:600;margin-bottom:.15rem}
        .solution-content p{color:var(--gray-400);font-size:.8rem}
        .recommendations{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200);margin-bottom:2rem}
        .recommendations h3{font-family:'Space Grotesk',sans-serif;font-size:1.2rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:.5rem}
        .recommendations h3 svg{width:24px;height:24px;fill:var(--accent)}
        .recommendation-item{display:flex;gap:1rem;padding:1rem 0;border-bottom:1px solid var(--gray-200)}
        .recommendation-item:last-child{border-bottom:none}
        .recommendation-icon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center}
        .recommendation-icon svg{width:18px;height:18px}
        .recommendation-content h4{font-size:.9rem;font-weight:600}
        .recommendation-content p{font-size:.8rem;color:var(--gray-500)}
        .recommendation-content .pt-solution{color:var(--accent-dark);font-size:.75rem;font-weight:600;margin-top:.5rem;display:flex;align-items:center;gap:.25rem}
        .recommendation-content .pt-solution svg{width:14px;height:14px;fill:var(--accent-dark)}
        .results-cta{background:linear-gradient(135deg,var(--accent),var(--accent-dark));padding:2rem;border-radius:20px;text-align:center;color:var(--primary)}
        .results-cta h3{font-family:'Space Grotesk',sans-serif;font-size:1.4rem}
        .results-cta p{color:var(--secondary);margin-bottom:1rem;font-size:.9rem}
        .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:var(--primary);color:var(--white);padding:1rem 1.5rem;border-radius:12px;z-index:2000;display:none;align-items:center;gap:.5rem}
        .toast.show{display:flex}
        .toast.success{background:var(--success)}
        .toast svg{width:20px;height:20px;fill:var(--white)}
        footer{background:var(--primary);color:var(--white);padding:2rem;text-align:center}
        footer p{color:var(--gray-400);font-size:.85rem;margin-bottom:.5rem}
        footer a{color:var(--accent)}
        .footer-tagline{color:var(--accent);font-weight:600;margin-top:.75rem}
    </style>
</head>
<body>
    <!-- SVG Icons Definition -->
    <svg style="display:none">
        <symbol id="icon-shield" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></symbol>
        <symbol id="icon-clock" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-grid" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></symbol>
        <symbol id="icon-file" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-play" viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"/></symbol>
        <symbol id="icon-check" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-server" viewBox="0 0 24 24"><rect x="2" y="2" width="20" height="8" rx="2" ry="2"/><rect x="2" y="14" width="20" height="8" rx="2" ry="2"/><line x1="6" y1="6" x2="6.01" y2="6" stroke="currentColor" stroke-width="2"/><line x1="6" y1="18" x2="6.01" y2="18" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-database" viewBox="0 0 24 24"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></symbol>
        <symbol id="icon-lock" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-arrow-right" viewBox="0 0 24 24"><line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2"/><polyline points="12 5 19 12 12 19" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-arrow-left" viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12" stroke="currentColor" stroke-width="2"/><polyline points="12 19 5 12 12 5" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-building" viewBox="0 0 24 24"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><line x1="9" y1="6" x2="9" y2="6.01" stroke="currentColor" stroke-width="2"/><line x1="15" y1="6" x2="15" y2="6.01" stroke="currentColor" stroke-width="2"/><line x1="9" y1="10" x2="9" y2="10.01" stroke="currentColor" stroke-width="2"/><line x1="15" y1="10" x2="15" y2="10.01" stroke="currentColor" stroke-width="2"/><line x1="9" y1="14" x2="9" y2="14.01" stroke="currentColor" stroke-width="2"/><line x1="15" y1="14" x2="15" y2="14.01" stroke="currentColor" stroke-width="2"/><path d="M9 18h6v4H9z"/></symbol>
        <symbol id="icon-download" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10" fill="none" stroke="currentColor" stroke-width="2"/><line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-refresh" viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10" fill="none" stroke="currentColor" stroke-width="2"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-chart" viewBox="0 0 24 24"><line x1="18" y1="20" x2="18" y2="10" stroke="currentColor" stroke-width="2"/><line x1="12" y1="20" x2="12" y2="4" stroke="currentColor" stroke-width="2"/><line x1="6" y1="20" x2="6" y2="14" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-tools" viewBox="0 0 24 24"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></symbol>
        <symbol id="icon-list" viewBox="0 0 24 24"><line x1="8" y1="6" x2="21" y2="6" stroke="currentColor" stroke-width="2"/><line x1="8" y1="12" x2="21" y2="12" stroke="currentColor" stroke-width="2"/><line x1="8" y1="18" x2="21" y2="18" stroke="currentColor" stroke-width="2"/><circle cx="4" cy="6" r="1"/><circle cx="4" cy="12" r="1"/><circle cx="4" cy="18" r="1"/></symbol>
        <symbol id="icon-trophy" viewBox="0 0 24 24"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 22V8.5a4 4 0 1 1 4 0V22"/></symbol>
        <symbol id="icon-video" viewBox="0 0 24 24"><rect x="2" y="7" width="15" height="10" rx="2" ry="2"/><polygon points="17 9 22 6 22 18 17 15 17 9"/></symbol>
        <symbol id="icon-bolt" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></symbol>
        <symbol id="icon-users" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></symbol>
        <symbol id="icon-globe" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="2"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></symbol>
        <symbol id="icon-graduation" viewBox="0 0 24 24"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c0 2 2 3 6 3s6-1 6-3v-5"/></symbol>
        <symbol id="icon-key" viewBox="0 0 24 24"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/></symbol>
        <symbol id="icon-crosshair" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/><line x1="22" y1="12" x2="18" y2="12" stroke="currentColor" stroke-width="2"/><line x1="6" y1="12" x2="2" y2="12" stroke="currentColor" stroke-width="2"/><line x1="12" y1="6" x2="12" y2="2" stroke="currentColor" stroke-width="2"/><line x1="12" y1="22" x2="12" y2="18" stroke="currentColor" stroke-width="2"/></symbol>
        <symbol id="icon-mail" viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    </svg>

    <div class="modal-overlay" id="consentModal">
        <div class="modal">
            <h2><svg><use href="#icon-shield"/></svg> Protection de vos données</h2>
            <p style="color:var(--gray-500);text-align:center">Bienvenue sur <strong>ProgiCheck</strong> !</p>
            <ul>
                <li>Données sécurisées, jamais revendues</li>
                <li>Progress Things pourra vous accompagner</li>
                <li>Droits: technique.bf@progressthings.com</li>
            </ul>
            <div class="modal-checkbox"><input type="checkbox" id="consentCheck"><label for="consentCheck">J'accepte le traitement de mes données par <strong>Progress Things</strong>.</label></div>
            <button class="modal-btn" id="consentBtn" disabled onclick="acceptConsent()">Accepter et continuer</button>
        </div>
    </div>

    <header>
        <div class="logo">
            <svg class="logo-icon" viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="45" stroke="#00D4AA" stroke-width="3" fill="none"/><circle cx="50" cy="50" r="30" stroke="#00D4AA" stroke-width="2" fill="none"/><circle cx="50" cy="50" r="15" stroke="#00D4AA" stroke-width="2" fill="none"/><circle cx="50" cy="50" r="5" fill="#00D4AA"/></svg>
            <div class="logo-text">Progi<span>Check</span></div>
        </div>
        <a href="https://www.progressthings.com" target="_blank" class="header-pt">by <strong>Progress Things</strong></a>
    </header>

    <main>
        <section id="home" class="section active">
            <div class="container">
                <div class="hero">
                    <div class="hero-badge"><svg><use href="#icon-crosshair"/></svg> Diagnostic complet en 9 catégories</div>
                    <h1>Évaluez la <span>maturité numérique</span> de votre entreprise</h1>
                    <p class="hero-subtitle">Un diagnostic professionnel gratuit basé sur les critères DIC pour les TPE et PME africaines.</p>
                    <button class="hero-cta" onclick="startDiagnostic()"><svg><use href="#icon-play"/></svg> Commencer gratuitement</button>
                    <div class="free-badge"><svg><use href="#icon-check"/></svg> 100% Gratuit - PDF inclus</div>
                    <div class="features">
                        <div class="feature-card"><div class="icon icon-accent"><svg><use href="#icon-clock"/></svg></div><h3>12 minutes</h3><p>27 questions ciblées</p></div>
                        <div class="feature-card"><div class="icon icon-accent"><svg><use href="#icon-grid"/></svg></div><h3>9 catégories</h3><p>Analyse complète</p></div>
                        <div class="feature-card"><div class="icon icon-accent"><svg><use href="#icon-shield"/></svg></div><h3>Approche DIC</h3><p>Méthodologie pro</p></div>
                        <div class="feature-card"><div class="icon icon-accent"><svg><use href="#icon-file"/></svg></div><h3>Rapport PDF</h3><p>Téléchargeable</p></div>
                    </div>
                    <div class="dic-banner">
                        <h3><svg><use href="#icon-shield"/></svg> Méthodologie DIC</h3>
                        <div class="dic-grid">
                            <div class="dic-item"><div class="icon icon-success"><svg><use href="#icon-server"/></svg></div><h4>Disponibilité</h4><p>Systèmes accessibles</p></div>
                            <div class="dic-item"><div class="icon icon-blue"><svg><use href="#icon-database"/></svg></div><h4>Intégrité</h4><p>Données protégées</p></div>
                            <div class="dic-item"><div class="icon icon-purple"><svg><use href="#icon-lock"/></svg></div><h4>Confidentialité</h4><p>Accès contrôlés</p></div>
                        </div>
                    </div>
                    <div class="pt-banner"><p>Développé par</p><div class="tagline">Progress Things — Let's do it together</div></div>
                </div>
            </div>
        </section>

        <section id="lead-form" class="section">
            <div class="container">
                <div class="form-section">
                    <div class="form-header"><h2><svg><use href="#icon-building"/></svg> Vos informations</h2><p style="color:var(--gray-500)">Pour personnaliser votre rapport gratuit</p></div>
                    <div class="form-card">
                        <form id="leadForm">
                            <div class="form-group"><label>Nom de l'entreprise <span class="required">*</span></label><input type="text" id="companyName" required placeholder="Ex: SARL Exemple"></div>
                            <div class="form-group"><label>Votre nom <span class="required">*</span></label><input type="text" id="contactName" required placeholder="Ex: Jean Dupont"></div>
                            <div class="form-group"><label>Email <span class="required">*</span></label><input type="email" id="contactEmail" required placeholder="Ex: jean@entreprise.com"></div>
                            <div class="form-group"><label>Téléphone</label><input type="tel" id="contactPhone" placeholder="+226 XX XX XX XX"></div>
                            <div class="form-group"><label>Secteur <span class="required">*</span></label><select id="sector" required><option value="">Sélectionnez</option><option>Commerce / Distribution</option><option>Services aux entreprises</option><option>Industrie / Production</option><option>Banque / Finance / Assurance</option><option>Santé</option><option>Éducation / Formation</option><option>ONG / Association</option><option>Technologies / IT</option><option>BTP / Construction</option><option>Transport / Logistique</option><option>Autre</option></select></div>
                            <div class="form-group"><label>Employés <span class="required">*</span></label><select id="employees" required><option value="">Sélectionnez</option><option>1-10</option><option>11-50</option><option>51-200</option><option>200+</option></select></div>
                            <div class="nav-buttons"><button type="button" class="btn btn-secondary" onclick="showSection('home')"><svg><use href="#icon-arrow-left"/></svg> Retour</button><button type="submit" class="btn btn-primary">Commencer <svg><use href="#icon-arrow-right"/></svg></button></div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <section id="quiz" class="section">
            <div class="container">
                <div class="quiz-header"><h2>Diagnostic en cours</h2><div class="progress-container"><div class="progress-bar" id="progressBar"></div></div><p class="progress-text"><span id="currentQuestion">1</span>/<span id="totalQuestions">27</span></p></div>
                <div style="text-align:center"><div class="category-indicator"><svg id="categoryIconSvg"><use href="#icon-server"/></svg> <span id="categoryName">Infrastructure IT</span></div></div>
                <div class="question-card">
                    <div class="question-dic" id="questionDic"><svg><use href="#icon-server"/></svg> <span>Disponibilité</span></div>
                    <p class="question-text" id="questionText">Chargement...</p>
                    <div class="options" id="optionsContainer"></div>
                </div>
                <div class="nav-buttons"><button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()" disabled><svg><use href="#icon-arrow-left"/></svg> Précédent</button><button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>Suivant <svg><use href="#icon-arrow-right"/></svg></button></div>
            </div>
        </section>

        <section id="results" class="section">
            <div class="container">
                <div class="results-header"><h2><svg><use href="#icon-check"/></svg> Diagnostic terminé !</h2><p id="resultsCompanyName"></p></div>
                <div class="score-display">
                    <div class="score-circle" id="scoreCircle" style="--score:0"><div class="score-value"><span id="scoreValue">0</span><span>/100</span></div></div>
                    <p class="score-label" id="scoreLabel">Niveau</p>
                    <p class="score-description" id="scoreDescription"></p>
                    <div class="dic-scores">
                        <div class="dic-score-item"><div class="label"><svg><use href="#icon-server"/></svg> Disponibilité</div><div class="value" id="dicDisp">0%</div></div>
                        <div class="dic-score-item"><div class="label"><svg><use href="#icon-database"/></svg> Intégrité</div><div class="value" id="dicInt">0%</div></div>
                        <div class="dic-score-item"><div class="label"><svg><use href="#icon-lock"/></svg> Confidentialité</div><div class="value" id="dicConf">0%</div></div>
                    </div>
                </div>
                <div class="download-section"><button class="btn btn-accent" onclick="downloadPDF()"><svg><use href="#icon-download"/></svg> Télécharger mon rapport PDF</button><button class="btn btn-secondary" onclick="location.reload()"><svg><use href="#icon-refresh"/></svg> Nouveau diagnostic</button></div>
                <div class="chart-container"><h3><svg><use href="#icon-chart"/></svg> Analyse par catégorie</h3><canvas id="radarChart"></canvas></div>
                <div class="category-scores" id="categoryScores"></div>
                <div class="solutions-section"><h3><svg><use href="#icon-tools"/></svg> Solutions Progress Things adaptées</h3><div id="solutionsList"></div></div>
                <div class="recommendations"><h3><svg><use href="#icon-list"/></svg> Recommandations prioritaires</h3><div id="recommendationsList"></div></div>
                <div class="results-cta"><h3>Besoin d'un accompagnement personnalisé ?</h3><p>Nos experts peuvent vous aider à mettre en œuvre ces recommandations.</p><a href="https://www.progressthings.com" target="_blank" class="btn" style="background:var(--primary);color:var(--white)">Contacter Progress Things <svg style="fill:white;width:18px;height:18px"><use href="#icon-arrow-right"/></svg></a><p style="margin-top:1rem;font-size:.8rem"><svg style="width:14px;height:14px;fill:var(--primary);vertical-align:middle"><use href="#icon-mail"/></svg> technique.bf@progressthings.com</p></div>
            </div>
        </section>
    </main>

    <div class="toast" id="toast"><svg><use href="#icon-check"/></svg> <span id="toastMessage"></span></div>
    <footer><p style="font-size:1.1rem;font-weight:600">Progi<span style="color:#00D4AA">Check</span></p><p>by <a href="https://www.progressthings.com">Progress Things</a></p><p>© 2024 — Diagnostic gratuit</p><p class="footer-tagline">Let's do it together</p></footer>

<script>
// ========== CONFIGURATION EMAILJS ==========
const EMAILJS_PUBLIC_KEY = "LF6930gGEBQZK63sJ";
const EMAILJS_SERVICE_ID = "service_y7puafd";
const EMAILJS_TEMPLATE_ID = "template_o67tdos";

document.addEventListener('DOMContentLoaded', function() {
    emailjs.init(EMAILJS_PUBLIC_KEY);
    console.log('EmailJS initialisé');
});

document.getElementById('consentCheck').addEventListener('change', function() { document.getElementById('consentBtn').disabled = !this.checked; });
function acceptConsent() { document.getElementById('consentModal').classList.add('hidden'); localStorage.setItem('progicheck_consent', 'true'); }
if (localStorage.getItem('progicheck_consent') === 'true') document.getElementById('consentModal').classList.add('hidden');
function startDiagnostic() { showSection('lead-form'); }

const catIcons = {
    infrastructure: '#icon-server', cybersecurity: '#icon-lock', physical_security: '#icon-video',
    continuity: '#icon-bolt', data_recovery: '#icon-database', collaboration: '#icon-users',
    digital_presence: '#icon-globe', skills: '#icon-graduation', identity: '#icon-key'
};
const dicIcons = { 'Disponibilité': '#icon-server', 'Intégrité': '#icon-database', 'Confidentialité': '#icon-lock' };

const categories = [
    {id:'infrastructure', name:'Infrastructure IT', pdfName:'Infrastructure', questions:[
        {text:"Quel est l'état de vos équipements informatiques ?", dic:"Disponibilité", options:[{text:"Très anciens (+7 ans), pannes fréquentes",score:0},{text:"Anciens (5-7 ans), quelques problèmes",score:1},{text:"Corrects (3-5 ans)",score:2},{text:"Récents (-3 ans), performants",score:3}]},
        {text:"Comment est organisé votre réseau ?", dic:"Disponibilité", options:[{text:"Pas de réseau structuré",score:0},{text:"Basique sans documentation",score:1},{text:"Structuré avec switch/routeur",score:2},{text:"Segmenté, documenté, monitoring",score:3}]},
        {text:"Avez-vous un contrat de maintenance ?", dic:"Disponibilité", options:[{text:"Non, on répare quand ça casse",score:0},{text:"Technicien ponctuel",score:1},{text:"Contrat curatif",score:2},{text:"Contrat préventif avec SLA",score:3}]}
    ]},
    {id:'cybersecurity', name:'Cybersécurité', pdfName:'Cybersecurite', questions:[
        {text:"Quelle protection sur vos postes de travail ?", dic:"Intégrité", options:[{text:"Aucune ou antivirus expiré",score:0},{text:"Antivirus gratuit",score:1},{text:"Antivirus payant à jour",score:2},{text:"Solution EDR/XDR",score:3}]},
        {text:"Comment gérez-vous les sauvegardes ?", dic:"Intégrité", options:[{text:"Pas de sauvegarde",score:0},{text:"Manuelle sur clé USB",score:1},{text:"Automatique locale",score:2},{text:"Règle 3-2-1 avec cloud",score:3}]},
        {text:"Sensibilisation au phishing ?", dic:"Confidentialité", options:[{text:"Jamais faite",score:0},{text:"Consignes informelles",score:1},{text:"Formation ponctuelle",score:2},{text:"Programme régulier + tests",score:3}]}
    ]},
    {id:'physical_security', name:'Sécurité Physique', pdfName:'Securite Physique', questions:[
        {text:"Système de vidéosurveillance ?", dic:"Confidentialité", options:[{text:"Aucun",score:0},{text:"Caméras non fonctionnelles",score:1},{text:"Caméras + enregistrement local",score:2},{text:"IP + stockage sécurisé",score:3}]},
        {text:"Contrôle d'accès aux locaux ?", dic:"Confidentialité", options:[{text:"Portes ouvertes",score:0},{text:"Clés physiques simples",score:1},{text:"Badges ou codes",score:2},{text:"Badges + traçabilité",score:3}]},
        {text:"Système d'alarme ?", dic:"Disponibilité", options:[{text:"Aucun",score:0},{text:"Basique non connectée",score:1},{text:"Connectée + notification",score:2},{text:"Télésurveillance 24/7",score:3}]}
    ]},
    {id:'continuity', name:'Continuité', pdfName:'Continuite', questions:[
        {text:"Protection contre les coupures électriques ?", dic:"Disponibilité", options:[{text:"Aucune",score:0},{text:"Quelques onduleurs",score:1},{text:"Onduleurs sur postes critiques",score:2},{text:"Onduleur central + groupe",score:3}]},
        {text:"Autonomie en cas de coupure ?", dic:"Disponibilité", options:[{text:"Aucune",score:0},{text:"Moins de 10 min",score:1},{text:"10-30 minutes",score:2},{text:"Plus de 30 minutes",score:3}]},
        {text:"Plan de continuité (PCA) ?", dic:"Disponibilité", options:[{text:"Non existant",score:0},{text:"Réflexions informelles",score:1},{text:"Procédures basiques",score:2},{text:"PCA documenté et testé",score:3}]}
    ]},
    {id:'data_recovery', name:'Données & Reprise', pdfName:'Donnees', questions:[
        {text:"Stockage des données critiques ?", dic:"Intégrité", options:[{text:"Fichiers dispersés",score:0},{text:"Dossiers partagés",score:1},{text:"Serveur/NAS centralisé",score:2},{text:"BDD/ERP + accès contrôlé",score:3}]},
        {text:"Plan de reprise (PRA) ?", dic:"Disponibilité", options:[{text:"Non existant",score:0},{text:"Idée générale",score:1},{text:"Procédures non testées",score:2},{text:"PRA documenté et testé",score:3}]},
        {text:"Temps de reprise après panne majeure ?", dic:"Disponibilité", options:[{text:"Plusieurs jours",score:0},{text:"1-2 jours",score:1},{text:"Quelques heures",score:2},{text:"Moins d'1h (RTO défini)",score:3}]}
    ]},
    {id:'collaboration', name:'Collaboration', pdfName:'Collaboration', questions:[
        {text:"Messagerie professionnelle ?", dic:"Confidentialité", options:[{text:"Gmail/Yahoo personnel",score:0},{text:"Gmail pro gratuit",score:1},{text:"Email pro basique",score:2},{text:"Microsoft 365 / Workspace",score:3}]},
        {text:"Partage de fichiers ?", dic:"Intégrité", options:[{text:"Clés USB",score:0},{text:"WhatsApp/WeTransfer",score:1},{text:"Drive basique",score:2},{text:"OneDrive/SharePoint + droits",score:3}]},
        {text:"Outils de communication équipe ?", dic:"Disponibilité", options:[{text:"Téléphone/SMS",score:0},{text:"WhatsApp personnel",score:1},{text:"Zoom/Meet occasionnel",score:2},{text:"Teams/Slack quotidien",score:3}]}
    ]},
    {id:'digital_presence', name:'Présence digitale', pdfName:'Digital', questions:[
        {text:"Site web professionnel ?", dic:"Disponibilité", options:[{text:"Aucun",score:0},{text:"Page Facebook uniquement",score:1},{text:"Site vitrine basique",score:2},{text:"Site pro, responsive, à jour",score:3}]},
        {text:"Réseaux sociaux professionnels ?", dic:"Disponibilité", options:[{text:"Aucune présence",score:0},{text:"Comptes inactifs",score:1},{text:"Actif mais irrégulier",score:2},{text:"Stratégie régulière",score:3}]},
        {text:"Contact en ligne ?", dic:"Disponibilité", options:[{text:"Téléphone uniquement",score:0},{text:"Email visible",score:1},{text:"Formulaire contact",score:2},{text:"Multi-canaux (chat, form...)",score:3}]}
    ]},
    {id:'skills', name:'Compétences', pdfName:'Competences', questions:[
        {text:"Niveau IT des employés ?", dic:"Intégrité", options:[{text:"Très basique",score:0},{text:"Basique",score:1},{text:"Correct, autonomes",score:2},{text:"Bon niveau",score:3}]},
        {text:"Formations IT ?", dic:"Intégrité", options:[{text:"Jamais",score:0},{text:"Très rarement",score:1},{text:"Occasionnellement",score:2},{text:"Plan de formation régulier",score:3}]},
        {text:"Support IT interne ou externe ?", dic:"Disponibilité", options:[{text:"Chacun se débrouille",score:0},{text:"Collègue 'qui s'y connaît'",score:1},{text:"Prestataire externe",score:2},{text:"Support dédié + ticketing",score:3}]}
    ]},
    {id:'identity', name:'Gestion des identités', pdfName:'Identites', questions:[
        {text:"Gestion des comptes utilisateurs ?", dic:"Confidentialité", options:[{text:"Comptes partagés",score:0},{text:"Comptes individuels sans procédure",score:1},{text:"Procédure création/suppression",score:2},{text:"Annuaire centralisé (AD)",score:3}]},
        {text:"Gestion des droits d'accès ?", dic:"Confidentialité", options:[{text:"Tout le monde accède à tout",score:0},{text:"Restrictions informelles",score:1},{text:"Droits par service/rôle",score:2},{text:"Principe moindre privilège",score:3}]},
        {text:"Authentification multi-facteurs (MFA) ?", dic:"Confidentialité", options:[{text:"Non, concept inconnu",score:0},{text:"Non, mais concept connu",score:1},{text:"Sur certains comptes",score:2},{text:"Obligatoire partout",score:3}]}
    ]}
];

const ptSolutions = {
    infrastructure: {name:"Support IT Managé", desc:"Maintenance préventive"},
    cybersecurity: {name:"Cybersécurité ESET", desc:"EDR, sauvegarde cloud"},
    physical_security: {name:"Vidéosurveillance", desc:"Caméras IP, accès"},
    continuity: {name:"Continuité électrique", desc:"Onduleurs, groupe"},
    data_recovery: {name:"Backup & Reprise", desc:"Sauvegarde 3-2-1"},
    collaboration: {name:"Microsoft 365", desc:"Outlook, Teams"},
    digital_presence: {name:"Conseil Digital", desc:"Site web, réseaux"},
    skills: {name:"Formations IT", desc:"M365, cybersécurité"},
    identity: {name:"Gestion identités", desc:"Entra ID, MFA"}
};

const levelDescriptions = {
    beginner: {label:"Débutant", desc:"Fort potentiel d'amélioration."},
    developing: {label:"En développement", desc:"Bases posées, à structurer."},
    intermediate: {label:"Intermédiaire", desc:"Bonne maturité."},
    advanced: {label:"Avancé", desc:"IT bien structurée."},
    expert: {label:"Expert", desc:"Excellente maturité!"}
};

let currentQuestionIndex = 0, answers = [], leadData = {};
const totalQuestions = categories.reduce((s, c) => s + c.questions.length, 0);

function showToast(m, t = 'info') { const e = document.getElementById('toast'); document.getElementById('toastMessage').textContent = m; e.className = 'toast show ' + t; setTimeout(() => e.classList.remove('show'), 3000); }
function showSection(id) { document.querySelectorAll('.section').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); window.scrollTo(0, 0); }

document.getElementById('leadForm').addEventListener('submit', function(e) {
    e.preventDefault();
    leadData = { companyName: document.getElementById('companyName').value, contactName: document.getElementById('contactName').value, contactEmail: document.getElementById('contactEmail').value, contactPhone: document.getElementById('contactPhone').value || 'N/A', sector: document.getElementById('sector').value, employees: document.getElementById('employees').value, date: new Date().toLocaleDateString('fr-FR') };
    currentQuestionIndex = 0; answers = new Array(totalQuestions).fill(null);
    document.getElementById('totalQuestions').textContent = totalQuestions;
    showSection('quiz'); displayQuestion();
});

function getQuestionData(idx) { let c = 0; for (let cat of categories) { for (let q of cat.questions) { if (c === idx) return {category: cat, question: q}; c++; } } return null; }

function displayQuestion() {
    const d = getQuestionData(currentQuestionIndex); if (!d) return;
    document.getElementById('categoryIconSvg').innerHTML = '<use href="' + catIcons[d.category.id] + '"/>';
    document.getElementById('categoryName').textContent = d.category.name;
    document.getElementById('questionText').textContent = d.question.text;
    document.getElementById('questionDic').innerHTML = '<svg><use href="' + dicIcons[d.question.dic] + '"/></svg> <span>' + d.question.dic + '</span>';
    const cont = document.getElementById('optionsContainer'); cont.innerHTML = '';
    d.question.options.forEach((o, i) => { const div = document.createElement('div'); div.className = 'option' + (answers[currentQuestionIndex] === i ? ' selected' : ''); div.onclick = () => selectOption(i); div.innerHTML = '<div class="option-radio"></div><span class="option-text">' + o.text + '</span>'; cont.appendChild(div); });
    document.getElementById('progressBar').style.width = ((currentQuestionIndex + 1) / totalQuestions * 100) + '%';
    document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;
    document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
    updateNextButton();
}

function selectOption(i) { answers[currentQuestionIndex] = i; document.querySelectorAll('.option').forEach((o, idx) => o.classList.toggle('selected', idx === i)); updateNextButton(); }
function updateNextButton() { const b = document.getElementById('nextBtn'); b.disabled = answers[currentQuestionIndex] === null; b.innerHTML = currentQuestionIndex === totalQuestions - 1 ? 'Voir résultats <svg><use href="#icon-chart"/></svg>' : 'Suivant <svg><use href="#icon-arrow-right"/></svg>'; }
function nextQuestion() { if (answers[currentQuestionIndex] === null) return; if (currentQuestionIndex < totalQuestions - 1) { currentQuestionIndex++; displayQuestion(); } else { calculateResults(); } }
function previousQuestion() { if (currentQuestionIndex > 0) { currentQuestionIndex--; displayQuestion(); } }

function calculateResults() {
    const catScores = {}, dicScores = {'Disponibilité': [], 'Intégrité': [], 'Confidentialité': []}; let qIdx = 0;
    categories.forEach(cat => { let s = 0, m = cat.questions.length * 3; cat.questions.forEach(q => { if (answers[qIdx] !== null) { const sc = q.options[answers[qIdx]].score; s += sc; dicScores[q.dic].push(sc / 3 * 100); } qIdx++; }); catScores[cat.id] = {name: cat.name, pdfName: cat.pdfName, score: Math.round(s / m * 100)}; });
    const total = Math.round(Object.values(catScores).reduce((s, c) => s + c.score, 0) / categories.length);
    const dicFinal = { disponibilite: Math.round(dicScores['Disponibilité'].reduce((a, b) => a + b, 0) / dicScores['Disponibilité'].length), integrite: Math.round(dicScores['Intégrité'].reduce((a, b) => a + b, 0) / dicScores['Intégrité'].length), confidentialite: Math.round(dicScores['Confidentialité'].reduce((a, b) => a + b, 0) / dicScores['Confidentialité'].length) };
    displayResults(total, catScores, dicFinal);
    sendEmail(total, catScores, dicFinal);
}

function getLevel(s) { if (s < 30) return 'beginner'; if (s < 50) return 'developing'; if (s < 70) return 'intermediate'; if (s < 90) return 'advanced'; return 'expert'; }
function getInterp(id, s) { const i = {infrastructure:{l:"Modernisation urgente",m:"Correcte",h:"Bonne"},cybersecurity:{l:"Très vulnérable",m:"Partielle",h:"Bonne"},physical_security:{l:"Insuffisante",m:"Partielle",h:"Bonne"},continuity:{l:"Aucune résilience",m:"Partielle",h:"Bonne"},data_recovery:{l:"Risque perte",m:"Partiel",h:"Bonne"},collaboration:{l:"Inadaptés",m:"Sous-utilisés",h:"Efficace"},digital_presence:{l:"Invisible",m:"Basique",h:"Bonne"},skills:{l:"Insuffisantes",m:"Correctes",h:"Compétentes"},identity:{l:"Chaotique",m:"Partielle",h:"Bonne"}}; return i[id]?.[s < 40 ? 'l' : s < 70 ? 'm' : 'h'] || ""; }

function sendEmail(score, catScores, dicFinal) {
    let allAnswers = '', qNum = 1, qIdx = 0;
    categories.forEach(cat => { allAnswers += '\n--- ' + cat.pdfName + ' (' + catScores[cat.id].score + '%) ---\n'; cat.questions.forEach(q => { const sel = answers[qIdx]; allAnswers += 'Q' + qNum + '. ' + q.text + '\n> ' + (sel !== null ? q.options[sel].text + ' (' + q.options[sel].score + '/3)' : 'N/A') + '\n'; qNum++; qIdx++; }); });
    const data = { subject: '[ProgiCheck] ' + leadData.companyName + ' - ' + score + '/100', company_name: leadData.companyName, contact_name: leadData.contactName, contact_email: leadData.contactEmail, contact_phone: leadData.contactPhone, sector: leadData.sector, employees: leadData.employees, version: 'GRATUIT', date: leadData.date, score: score, level: levelDescriptions[getLevel(score)].label, dic_disponibilite: dicFinal.disponibilite + '%', dic_integrite: dicFinal.integrite + '%', dic_confidentialite: dicFinal.confidentialite + '%', category_scores: Object.entries(catScores).map(([id, c]) => c.pdfName + ':' + c.score + '%').join(' | '), all_answers: allAnswers };
    emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, data).then(() => console.log('Email envoyé!')).catch(e => console.error('Erreur:', e));
    console.log('DIAGNOSTIC:', data);
}

function displayResults(total, catScores, dicFinal) {
    showSection('results');
    document.getElementById('resultsCompanyName').textContent = leadData.companyName;
    document.getElementById('dicDisp').textContent = dicFinal.disponibilite + '%';
    document.getElementById('dicInt').textContent = dicFinal.integrite + '%';
    document.getElementById('dicConf').textContent = dicFinal.confidentialite + '%';
    const circle = document.getElementById('scoreCircle'), val = document.getElementById('scoreValue'); let cur = 0;
    const anim = setInterval(() => { if (cur >= total) clearInterval(anim); else { cur++; val.textContent = cur; circle.style.setProperty('--score', cur); } }, 20);
    const level = getLevel(total), levelInfo = levelDescriptions[level];
    document.getElementById('scoreLabel').textContent = levelInfo.label;
    document.getElementById('scoreDescription').textContent = levelInfo.desc;
    const scCont = document.getElementById('categoryScores'); scCont.innerHTML = '';
    Object.entries(catScores).forEach(([id, c]) => { const lv = c.score < 40 ? 'low' : c.score < 70 ? 'medium' : 'high'; scCont.innerHTML += '<div class="category-score-card"><div class="category-score-header"><span class="category-score-name"><svg style="fill:currentColor"><use href="' + catIcons[id] + '"/></svg> ' + c.name + '</span><span class="category-score-value ' + lv + '">' + c.score + '%</span></div><div class="category-score-bar"><div class="category-score-fill ' + lv + '" style="width:' + c.score + '%"></div></div><p class="category-score-desc">' + getInterp(id, c.score) + '</p></div>'; });
    createRadarChart(catScores); generateSolutions(catScores); generateRecs(catScores);
    window.resultsData = {totalScore: total, categoryScores: catScores, dicFinal, level, levelInfo};
}

function createRadarChart(catScores) { const ctx = document.getElementById('radarChart').getContext('2d'); if (window.radarChartInstance) window.radarChartInstance.destroy(); window.radarChartInstance = new Chart(ctx, {type: 'radar', data: {labels: Object.values(catScores).map(c => c.pdfName), datasets: [{label: 'Score', data: Object.values(catScores).map(c => c.score), backgroundColor: 'rgba(0,212,170,0.2)', borderColor: '#00D4AA', borderWidth: 2, pointBackgroundColor: '#00D4AA'}]}, options: {responsive: true, scales: {r: {beginAtZero: true, max: 100, ticks: {stepSize: 20}}}, plugins: {legend: {display: false}}}}); }

function generateSolutions(catScores) { const cont = document.getElementById('solutionsList'); cont.innerHTML = ''; Object.entries(catScores).sort((a, b) => a[1].score - b[1].score).filter(([id, c]) => c.score < 70).slice(0, 4).forEach(([id]) => { const sol = ptSolutions[id]; if (sol) cont.innerHTML += '<div class="solution-card"><div class="solution-icon"><svg><use href="' + catIcons[id] + '"/></svg></div><div class="solution-content"><h4>' + sol.name + '</h4><p>' + sol.desc + '</p></div></div>'; }); if (!cont.innerHTML) cont.innerHTML = '<div class="solution-card"><div class="solution-icon"><svg><use href="#icon-trophy"/></svg></div><div class="solution-content"><h4>Félicitations!</h4><p>Excellente maturité.</p></div></div>'; }

function generateRecs(catScores) { const cont = document.getElementById('recommendationsList'); cont.innerHTML = ''; Object.entries(catScores).filter(([id, c]) => c.score < 70).sort((a, b) => a[1].score - b[1].score).slice(0, 5).forEach(([id, c]) => { const p = c.score < 40 ? 'high' : 'medium', sol = ptSolutions[id]; const iconClass = p === 'high' ? 'icon-danger' : 'icon-warning'; cont.innerHTML += '<div class="recommendation-item"><div class="recommendation-icon ' + iconClass + '"><svg style="fill:currentColor"><use href="' + catIcons[id] + '"/></svg></div><div class="recommendation-content"><h4>' + c.name + '</h4><p>' + getInterp(id, c.score) + '</p>' + (sol ? '<div class="pt-solution"><svg><use href="#icon-arrow-right"/></svg> ' + sol.name + '</div>' : '') + '</div></div>'; }); if (!cont.innerHTML) cont.innerHTML = '<div class="recommendation-item"><div class="recommendation-icon icon-success"><svg><use href="#icon-trophy"/></svg></div><div class="recommendation-content"><h4>Excellent!</h4><p>Continuez ainsi.</p></div></div>'; }

function downloadPDF() {
    const d = window.resultsData; if (!d) return;
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const pw = doc.internal.pageSize.getWidth(), ph = doc.internal.pageSize.getHeight();
    let y = 15, pageNum = 1;
    
    const footer = () => { doc.setFillColor(26,26,26); doc.rect(0,ph-10,pw,10,'F'); doc.setTextColor(255,255,255); doc.setFontSize(7); doc.text('ProgiCheck - Progress Things - www.progressthings.com - Page '+pageNum, pw/2, ph-4, {align:'center'}); };
    const header = (t) => { doc.setFillColor(26,26,26); doc.rect(0,0,pw,12,'F'); doc.setTextColor(0,212,170); doc.setFontSize(9); doc.setFont('helvetica','bold'); doc.text('ProgiCheck', 10, 8); doc.setTextColor(150,150,150); doc.setFontSize(7); doc.text(' - '+leadData.companyName+' - '+t, 32, 8); };
    const newPage = (t) => { footer(); doc.addPage(); pageNum++; header(t); return 18; };
    const checkPage = (n,t) => { if(y+n>ph-15) y=newPage(t); };

    doc.setFillColor(26,26,26); doc.rect(0,0,pw,25,'F');
    doc.setTextColor(0,212,170); doc.setFontSize(18); doc.setFont('helvetica','bold'); doc.text('ProgiCheck', 10, 15);
    doc.setTextColor(150,150,150); doc.setFontSize(8); doc.text(leadData.date, pw-10, 15, {align:'right'});
    
    y = 32;
    doc.setTextColor(26,26,26); doc.setFontSize(14); doc.setFont('helvetica','bold'); doc.text('RAPPORT DE MATURITE NUMERIQUE', pw/2, y, {align:'center'});
    y += 7; doc.setTextColor(0,212,170); doc.setFontSize(12); doc.text(leadData.companyName, pw/2, y, {align:'center'});
    y += 5; doc.setTextColor(100,100,100); doc.setFontSize(8); doc.setFont('helvetica','normal'); doc.text(leadData.sector+' | '+leadData.employees+' employes | '+leadData.contactEmail, pw/2, y, {align:'center'});
    
    y += 10;
    doc.setFillColor(26,26,26); doc.roundedRect(25,y,pw-50,30,4,4,'F');
    doc.setTextColor(0,212,170); doc.setFontSize(28); doc.setFont('helvetica','bold'); doc.text(d.totalScore+'/100', pw/2, y+15, {align:'center'});
    doc.setTextColor(255,255,255); doc.setFontSize(10); doc.text(d.levelInfo.label, pw/2, y+24, {align:'center'});
    y += 36;
    
    doc.setFillColor(240,240,240); doc.roundedRect(10,y,pw-20,10,2,2,'F');
    doc.setTextColor(26,26,26); doc.setFontSize(8); doc.setFont('helvetica','bold'); doc.text('DIC:', 15, y+7);
    doc.setTextColor(16,185,129); doc.text('D:'+d.dicFinal.disponibilite+'%', 30, y+7);
    doc.setTextColor(59,130,246); doc.text('I:'+d.dicFinal.integrite+'%', 55, y+7);
    doc.setTextColor(139,92,246); doc.text('C:'+d.dicFinal.confidentialite+'%', 75, y+7);
    y += 15;
    
    doc.setTextColor(26,26,26); doc.setFontSize(10); doc.setFont('helvetica','bold'); doc.text('SCORES PAR CATEGORIE', 10, y); y += 6;
    Object.entries(d.categoryScores).forEach(([id,c]) => {
        const col = c.score<40?[239,68,68]:c.score<70?[245,158,11]:[16,185,129];
        doc.setFillColor(230,230,230); doc.roundedRect(10,y,pw-20,8,2,2,'F');
        doc.setFillColor(...col); const bw=(pw-20)*c.score/100; if(bw>2)doc.roundedRect(10,y,bw,8,2,2,'F');
        doc.setTextColor(40,40,40); doc.setFontSize(7); doc.setFont('helvetica','bold'); doc.text(c.pdfName,13,y+5); doc.text(c.score+'%',pw-13,y+5,{align:'right'});
        y += 10;
    });
    
    y = newPage('Recommandations');
    doc.setTextColor(26,26,26); doc.setFontSize(11); doc.setFont('helvetica','bold'); doc.text('RECOMMANDATIONS PRIORITAIRES', 10, y); y += 8;
    Object.entries(d.categoryScores).sort((a,b)=>a[1].score-b[1].score).forEach(([id,c]) => {
        checkPage(18,'Recommandations');
        const col = c.score<40?[239,68,68]:c.score<70?[245,158,11]:[16,185,129];
        const prio = c.score<40?'URGENT':c.score<70?'A AMELIORER':'BON';
        doc.setFillColor(248,248,248); doc.roundedRect(10,y,pw-20,14,2,2,'F');
        doc.setFillColor(...col); doc.roundedRect(10,y,3,14,1,1,'F');
        doc.setTextColor(26,26,26); doc.setFontSize(8); doc.setFont('helvetica','bold'); doc.text(c.pdfName,16,y+5);
        doc.setFillColor(...col); doc.roundedRect(pw-45,y+1,22,5,1,1,'F'); doc.setTextColor(255,255,255); doc.setFontSize(5); doc.text(prio,pw-34,y+4.5,{align:'center'});
        doc.setTextColor(...col); doc.setFontSize(9); doc.text(c.score+'%',pw-15,y+5,{align:'right'});
        doc.setTextColor(80,80,80); doc.setFontSize(6); doc.setFont('helvetica','normal'); doc.text(getInterp(id,c.score),16,y+11);
        y += 16;
    });
    
    checkPage(30, 'Recommandations'); y+=5;
    doc.setFillColor(0,212,170); doc.roundedRect(10,y,pw-20,25,3,3,'F');
    doc.setTextColor(26,26,26); doc.setFontSize(10); doc.setFont('helvetica','bold');
    doc.text('Besoin d\'accompagnement ?',pw/2,y+8,{align:'center'});
    doc.setFontSize(8); doc.setFont('helvetica','normal');
    doc.text('Progress Things peut vous aider.',pw/2,y+14,{align:'center'});
    doc.setFont('helvetica','bold');
    doc.text('www.progressthings.com | technique.bf@progressthings.com',pw/2,y+21,{align:'center'});
    
    footer();
    doc.save('ProgiCheck_'+leadData.companyName.replace(/[^a-zA-Z0-9]/g,'_')+'.pdf');
    showToast('PDF telecharge!','success');
}
</script>
</body>
</html>
