<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProgiCheck by Progress Things ‚Äî Diagnostic Maturit√© Num√©rique TPE/PME</title>
    <meta name="description" content="√âvaluez gratuitement la maturit√© num√©rique de votre entreprise en 12 minutes.">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        :root{--primary:#1a1a1a;--secondary:#2d2d2d;--accent:#00D4AA;--accent-dark:#00B894;--white:#fff;--gray-100:#f7f7f7;--gray-200:#e5e5e5;--gray-300:#d4d4d4;--gray-400:#a3a3a3;--gray-500:#737373;--danger:#ef4444;--warning:#f59e0b;--success:#10b981;--pro-gold:#FFD700}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Inter',sans-serif;background:var(--gray-100);color:var(--primary);line-height:1.6}
        .modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;display:flex;align-items:center;justify-content:center;padding:1rem}
        .modal-overlay.hidden{display:none}
        .modal{background:var(--white);border-radius:20px;max-width:520px;width:100%;padding:2rem;animation:fadeIn .3s ease}
        .modal h2{font-family:'Space Grotesk',sans-serif;font-size:1.5rem;margin-bottom:1rem;color:var(--primary);text-align:center}
        .modal>p{color:var(--gray-500);font-size:.9rem;margin-bottom:1rem}
        .modal ul{margin:1rem 0;padding-left:1.5rem;color:var(--gray-500);font-size:.85rem}
        .modal ul li{margin-bottom:.5rem}
        .modal-checkbox{display:flex;align-items:flex-start;gap:.75rem;margin:1.5rem 0;padding:1rem;background:var(--gray-100);border-radius:10px}
        .modal-checkbox input{width:20px;height:20px;margin-top:2px;accent-color:var(--accent);cursor:pointer;flex-shrink:0}
        .modal-checkbox label{font-size:.85rem;color:var(--gray-500);cursor:pointer}
        .modal-btn{width:100%;padding:1rem;border-radius:50px;font-size:1rem;font-weight:600;cursor:pointer;border:none;transition:all .3s ease}
        .modal-btn:disabled{background:var(--gray-300);color:var(--gray-500);cursor:not-allowed}
        .modal-btn:not(:disabled){background:var(--accent);color:var(--primary)}
        .modal-btn:not(:disabled):hover{background:var(--accent-dark)}
        header{background:var(--primary);padding:1rem 2rem;position:fixed;top:0;left:0;right:0;z-index:1000;display:flex;justify-content:space-between;align-items:center}
        .logo{display:flex;align-items:center;gap:.75rem}
        .logo-icon{width:40px;height:40px}
        .logo-text{color:var(--white);font-family:'Space Grotesk',sans-serif;font-weight:700;font-size:1.25rem}
        .logo-text span{color:var(--accent)}
        .header-pt{color:var(--gray-400);font-size:.8rem;text-decoration:none;transition:color .3s}
        .header-pt:hover{color:var(--white)}
        .header-pt strong{color:var(--accent)}
        main{margin-top:72px;min-height:calc(100vh - 72px)}
        .container{max-width:900px;margin:0 auto;padding:2rem 1rem}
        .section{display:none;animation:fadeIn .4s ease}
        .section.active{display:block}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .hero{text-align:center;padding:3rem 1rem}
        .hero-badge{display:inline-block;background:var(--accent);color:var(--primary);padding:.5rem 1rem;border-radius:50px;font-size:.875rem;font-weight:600;margin-bottom:1.5rem}
        .hero h1{font-family:'Space Grotesk',sans-serif;font-size:2.5rem;font-weight:700;line-height:1.2;margin-bottom:1rem}
        .hero h1 span{color:var(--accent-dark)}
        .hero-subtitle{font-size:1.1rem;color:var(--gray-500);max-width:600px;margin:0 auto 2rem}
        .hero-cta{display:inline-flex;align-items:center;gap:.75rem;background:var(--primary);color:var(--white);padding:1rem 2rem;border-radius:50px;font-size:1.1rem;font-weight:600;cursor:pointer;border:none;transition:all .3s ease}
        .hero-cta:hover{background:var(--secondary);transform:translateY(-2px);box-shadow:0 10px 30px rgba(0,0,0,.2)}
        .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-top:3rem}
        .feature-card{background:var(--white);padding:1.25rem;border-radius:16px;border:1px solid var(--gray-200);text-align:center;transition:all .3s}
        .feature-card:hover{border-color:var(--accent);transform:translateY(-4px)}
        .feature-icon{font-size:2rem;margin-bottom:.5rem}
        .feature-card h3{font-family:'Space Grotesk',sans-serif;font-size:1rem;font-weight:600;margin-bottom:.25rem}
        .feature-card p{color:var(--gray-500);font-size:.8rem}
        .dic-banner{background:linear-gradient(135deg,var(--primary),var(--secondary));padding:2rem;border-radius:20px;margin-top:2rem;color:var(--white)}
        .dic-banner h3{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;margin-bottom:1rem;text-align:center}
        .dic-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
        @media(max-width:600px){.dic-grid{grid-template-columns:1fr}}
        .dic-item{text-align:center;padding:1rem;background:rgba(255,255,255,.05);border-radius:12px}
        .dic-item .icon{font-size:1.5rem;margin-bottom:.5rem}
        .dic-item h4{font-size:.9rem;margin-bottom:.25rem;color:var(--accent)}
        .dic-item p{font-size:.75rem;color:var(--gray-400)}
        .pt-banner{background:var(--accent);padding:1.5rem;border-radius:16px;margin-top:2rem;text-align:center;color:var(--primary)}
        .pt-banner p{font-weight:500;margin-bottom:.25rem}
        .pt-banner .tagline{font-weight:700}
        .free-badge{display:inline-block;background:var(--success);color:var(--white);padding:.25rem .75rem;border-radius:50px;font-size:.75rem;font-weight:600;margin-top:1rem}
        .form-section{max-width:500px;margin:0 auto}
        .form-header{text-align:center;margin-bottom:2rem}
        .form-header h2{font-family:'Space Grotesk',sans-serif;font-size:1.75rem;margin-bottom:.5rem}
        .form-card{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200)}
        .form-group{margin-bottom:1.25rem}
        .form-group label{display:block;font-weight:500;margin-bottom:.5rem;font-size:.875rem}
        .form-group .required{color:var(--danger)}
        .form-group input,.form-group select{width:100%;padding:.875rem 1rem;border:1px solid var(--gray-300);border-radius:10px;font-size:1rem;font-family:'Inter',sans-serif}
        .form-group input:focus,.form-group select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,212,170,.1)}
        .quiz-header{text-align:center;margin-bottom:2rem}
        .quiz-header h2{font-family:'Space Grotesk',sans-serif;font-size:1.5rem;margin-bottom:.5rem}
        .progress-container{background:var(--gray-200);height:8px;border-radius:4px;overflow:hidden;margin-bottom:.5rem}
        .progress-bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-dark));transition:width .4s}
        .progress-text{font-size:.875rem;color:var(--gray-500)}
        .category-indicator{display:inline-flex;align-items:center;gap:.5rem;background:var(--primary);color:var(--white);padding:.5rem 1rem;border-radius:50px;font-size:.875rem;font-weight:500;margin-bottom:1.5rem}
        .question-card{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200)}
        .question-dic{display:inline-block;font-size:.7rem;padding:.25rem .6rem;border-radius:4px;margin-bottom:.75rem;background:var(--gray-100);color:var(--gray-500)}
        .question-text{font-family:'Space Grotesk',sans-serif;font-size:1.2rem;font-weight:600;margin-bottom:1.5rem}
        .options{display:flex;flex-direction:column;gap:.75rem}
        .option{display:flex;align-items:center;padding:1rem;border:2px solid var(--gray-200);border-radius:12px;cursor:pointer;transition:all .2s}
        .option:hover{border-color:var(--accent);background:rgba(0,212,170,.05)}
        .option.selected{border-color:var(--accent);background:rgba(0,212,170,.1)}
        .option-radio{width:20px;height:20px;border:2px solid var(--gray-300);border-radius:50%;margin-right:1rem;display:flex;align-items:center;justify-content:center;flex-shrink:0}
        .option.selected .option-radio{border-color:var(--accent);background:var(--accent)}
        .option.selected .option-radio::after{content:'';width:8px;height:8px;background:var(--white);border-radius:50%}
        .option-text{font-size:.9rem}
        .nav-buttons{display:flex;justify-content:space-between;margin-top:2rem;gap:1rem}
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.875rem 1.5rem;border-radius:50px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s;border:none;text-decoration:none}
        .btn-primary{background:var(--primary);color:var(--white)}
        .btn-primary:hover{background:var(--secondary)}
        .btn-primary:disabled{background:var(--gray-300);cursor:not-allowed}
        .btn-secondary{background:var(--white);color:var(--primary);border:1px solid var(--gray-300)}
        .btn-secondary:hover{border-color:var(--primary)}
        .btn-accent{background:var(--accent);color:var(--primary)}
        .btn-accent:hover{background:var(--accent-dark)}
        .results-header{text-align:center;margin-bottom:2rem}
        .results-header h2{font-family:'Space Grotesk',sans-serif;font-size:2rem;margin-bottom:.5rem}
        .score-display{background:var(--primary);color:var(--white);padding:2.5rem 2rem;border-radius:24px;text-align:center;margin-bottom:2rem}
        .score-circle{width:150px;height:150px;border-radius:50%;background:conic-gradient(var(--accent) calc(var(--score) * 1%),var(--secondary) 0);display:flex;align-items:center;justify-content:center;margin:0 auto 1.5rem;position:relative}
        .score-circle::before{content:'';position:absolute;width:120px;height:120px;background:var(--primary);border-radius:50%}
        .score-value{position:relative;z-index:1;font-family:'Space Grotesk',sans-serif;font-size:2.5rem;font-weight:700}
        .score-value span{font-size:1.25rem;color:var(--gray-400)}
        .score-label{font-size:1.25rem;font-weight:600;margin-bottom:.5rem}
        .score-description{color:var(--gray-400);font-size:.9rem}
        .dic-scores{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid var(--secondary)}
        .dic-score-item{text-align:center}
        .dic-score-item .label{font-size:.7rem;color:var(--gray-400);margin-bottom:.25rem}
        .dic-score-item .value{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;font-weight:700;color:var(--accent)}
        .chart-container{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200);margin-bottom:2rem}
        .chart-container h3{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;margin-bottom:1.5rem;text-align:center}
        #radarChart{max-height:320px}
        .category-scores{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem;margin-bottom:2rem}
        .category-score-card{background:var(--white);padding:1.25rem;border-radius:16px;border:1px solid var(--gray-200)}
        .category-score-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}
        .category-score-name{font-weight:600;font-size:.9rem}
        .category-score-value{font-family:'Space Grotesk',sans-serif;font-weight:700;font-size:1.1rem}
        .category-score-value.low{color:var(--danger)}
        .category-score-value.medium{color:var(--warning)}
        .category-score-value.high{color:var(--success)}
        .category-score-bar{height:8px;background:var(--gray-200);border-radius:4px;overflow:hidden;margin-bottom:.5rem}
        .category-score-fill{height:100%;border-radius:4px}
        .category-score-fill.low{background:var(--danger)}
        .category-score-fill.medium{background:var(--warning)}
        .category-score-fill.high{background:var(--success)}
        .category-score-desc{font-size:.75rem;color:var(--gray-500)}
        .download-section{display:flex;justify-content:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}
        .solutions-section{background:linear-gradient(135deg,#1a1a1a,#2d2d2d);padding:2rem;border-radius:20px;margin-bottom:2rem;color:var(--white)}
        .solutions-section h3{font-family:'Space Grotesk',sans-serif;font-size:1.2rem;margin-bottom:1rem}
        .solution-card{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:1.25rem;margin-bottom:1rem}
        .solution-header{display:flex;align-items:center;gap:.75rem;margin-bottom:.5rem}
        .solution-icon{width:36px;height:36px;background:var(--accent);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.1rem}
        .solution-title{font-weight:600;font-size:.95rem}
        .solution-description{color:var(--gray-400);font-size:.8rem}
        .recommendations{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200);margin-bottom:2rem}
        .recommendations h3{font-family:'Space Grotesk',sans-serif;font-size:1.2rem;margin-bottom:1.5rem}
        .recommendation-item{display:flex;gap:1rem;padding:1rem 0;border-bottom:1px solid var(--gray-200)}
        .recommendation-item:last-child{border-bottom:none}
        .recommendation-icon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:1.1rem}
        .recommendation-icon.priority-high{background:rgba(239,68,68,.1)}
        .recommendation-icon.priority-medium{background:rgba(245,158,11,.1)}
        .recommendation-content h4{font-size:.9rem;font-weight:600;margin-bottom:.25rem}
        .recommendation-content p{font-size:.8rem;color:var(--gray-500)}
        .recommendation-content .pt-solution{color:var(--accent-dark);font-size:.75rem;font-weight:600;margin-top:.5rem}
        .results-cta{background:linear-gradient(135deg,var(--accent),var(--accent-dark));padding:2rem;border-radius:20px;text-align:center;color:var(--primary)}
        .results-cta h3{font-family:'Space Grotesk',sans-serif;font-size:1.4rem;margin-bottom:.5rem}
        .results-cta p{color:var(--secondary);margin-bottom:1rem;font-size:.9rem}
        .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:var(--primary);color:var(--white);padding:1rem 1.5rem;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);z-index:2000;display:none;align-items:center;gap:.75rem}
        .toast.show{display:flex}
        .toast.success{background:var(--success)}
        .toast.error{background:var(--danger)}
        footer{background:var(--primary);color:var(--white);padding:2rem;text-align:center}
        footer p{color:var(--gray-400);font-size:.85rem;margin-bottom:.5rem}
        footer a{color:var(--accent);text-decoration:none}
        .footer-tagline{color:var(--accent);font-weight:600;margin-top:.75rem}
    </style>
</head>
<body>
    <div class="modal-overlay" id="consentModal">
        <div class="modal">
            <h2>üîí Protection de vos donn√©es</h2>
            <p>Bienvenue sur <strong>ProgiCheck</strong> !</p>
            <ul>
                <li><strong>Finalit√© :</strong> G√©n√©rer votre rapport de maturit√© num√©rique.</li>
                <li><strong>Conservation :</strong> Donn√©es s√©curis√©es, jamais revendues.</li>
                <li><strong>Contact :</strong> Progress Things pourra vous accompagner.</li>
                <li><strong>Droits :</strong> technique.bf@progressthings.com</li>
            </ul>
            <div class="modal-checkbox">
                <input type="checkbox" id="consentCheck">
                <label for="consentCheck">J'accepte le traitement de mes donn√©es par <strong>Progress Things</strong>.</label>
            </div>
            <button class="modal-btn" id="consentBtn" disabled onclick="acceptConsent()">Commencer le diagnostic gratuit ‚Üí</button>
        </div>
    </div>

    <header>
        <div class="logo">
            <div class="logo-icon"><svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="45" stroke="#00D4AA" stroke-width="3" fill="none"/><circle cx="50" cy="50" r="30" stroke="#00D4AA" stroke-width="2" fill="none"/><circle cx="50" cy="50" r="15" stroke="#00D4AA" stroke-width="2" fill="none"/><circle cx="50" cy="50" r="5" fill="#00D4AA"/></svg></div>
            <div class="logo-text">Progi<span>Check</span></div>
        </div>
        <a href="https://www.progressthings.com" target="_blank" class="header-pt">by <strong>Progress Things</strong></a>
    </header>

    <main>
        <section id="home" class="section active">
            <div class="container">
                <div class="hero">
                    <div class="hero-badge">üéØ Diagnostic complet en 9 cat√©gories</div>
                    <h1>√âvaluez la <span>maturit√© num√©rique</span> de votre entreprise</h1>
                    <p class="hero-subtitle">Un diagnostic professionnel gratuit bas√© sur les crit√®res DIC pour les TPE et PME africaines.</p>
                    <button class="hero-cta" onclick="startDiagnostic()">üöÄ Commencer gratuitement</button>
                    <div class="free-badge">‚úì 100% Gratuit ‚Ä¢ PDF inclus</div>
                    <div class="features">
                        <div class="feature-card"><div class="feature-icon">‚è±Ô∏è</div><h3>12 minutes</h3><p>27 questions cibl√©es</p></div>
                        <div class="feature-card"><div class="feature-icon">üìä</div><h3>9 cat√©gories</h3><p>Analyse compl√®te</p></div>
                        <div class="feature-card"><div class="feature-icon">üõ°Ô∏è</div><h3>Approche DIC</h3><p>M√©thodologie pro</p></div>
                        <div class="feature-card"><div class="feature-icon">üìÑ</div><h3>Rapport PDF</h3><p>T√©l√©chargeable</p></div>
                    </div>
                    <div class="dic-banner">
                        <h3>üõ°Ô∏è M√©thodologie DIC</h3>
                        <div class="dic-grid">
                            <div class="dic-item"><div class="icon">üü¢</div><h4>Disponibilit√©</h4><p>Syst√®mes accessibles</p></div>
                            <div class="dic-item"><div class="icon">üîµ</div><h4>Int√©grit√©</h4><p>Donn√©es prot√©g√©es</p></div>
                            <div class="dic-item"><div class="icon">üü£</div><h4>Confidentialit√©</h4><p>Acc√®s contr√¥l√©s</p></div>
                        </div>
                    </div>
                    <div class="pt-banner"><p>D√©velopp√© par</p><div class="tagline">Progress Things ‚Äî Let's do it together</div></div>
                </div>
            </div>
        </section>

        <section id="lead-form" class="section">
            <div class="container">
                <div class="form-section">
                    <div class="form-header"><h2>üìù Vos informations</h2><p style="color:var(--gray-500)">Pour personnaliser votre rapport gratuit</p></div>
                    <div class="form-card">
                        <form id="leadForm">
                            <div class="form-group"><label>Nom de l'entreprise <span class="required">*</span></label><input type="text" id="companyName" required placeholder="Ex: SARL Exemple"></div>
                            <div class="form-group"><label>Votre nom <span class="required">*</span></label><input type="text" id="contactName" required placeholder="Ex: Jean Dupont"></div>
                            <div class="form-group"><label>Email <span class="required">*</span></label><input type="email" id="contactEmail" required placeholder="Ex: jean@entreprise.com"></div>
                            <div class="form-group"><label>T√©l√©phone</label><input type="tel" id="contactPhone" placeholder="+226 XX XX XX XX"></div>
                            <div class="form-group"><label>Secteur <span class="required">*</span></label><select id="sector" required><option value="">S√©lectionnez</option><option>Commerce / Distribution</option><option>Services aux entreprises</option><option>Industrie / Production</option><option>Banque / Finance / Assurance</option><option>Sant√©</option><option>√âducation / Formation</option><option>ONG / Association</option><option>Technologies / IT</option><option>BTP / Construction</option><option>Transport / Logistique</option><option>Autre</option></select></div>
                            <div class="form-group"><label>Employ√©s <span class="required">*</span></label><select id="employees" required><option value="">S√©lectionnez</option><option>1-10</option><option>11-50</option><option>51-200</option><option>200+</option></select></div>
                            <div class="nav-buttons"><button type="button" class="btn btn-secondary" onclick="showSection('home')">‚Üê Retour</button><button type="submit" class="btn btn-primary">Commencer ‚Üí</button></div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <section id="quiz" class="section">
            <div class="container">
                <div class="quiz-header"><h2>Diagnostic en cours</h2><div class="progress-container"><div class="progress-bar" id="progressBar"></div></div><p class="progress-text"><span id="currentQuestion">1</span>/<span id="totalQuestions">27</span></p></div>
                <div style="text-align:center"><div class="category-indicator"><span id="categoryIcon">üñ•Ô∏è</span> <span id="categoryName">Infrastructure IT</span></div></div>
                <div class="question-card">
                    <div class="question-dic" id="questionDic">Disponibilit√©</div>
                    <p class="question-text" id="questionText">Chargement...</p>
                    <div class="options" id="optionsContainer"></div>
                </div>
                <div class="nav-buttons"><button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()" disabled>‚Üê Pr√©c√©dent</button><button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>Suivant ‚Üí</button></div>
            </div>
        </section>

        <section id="results" class="section">
            <div class="container">
                <div class="results-header"><h2>üéâ Diagnostic termin√© !</h2><p id="resultsCompanyName"></p></div>
                <div class="score-display">
                    <div class="score-circle" id="scoreCircle" style="--score:0"><div class="score-value"><span id="scoreValue">0</span><span>/100</span></div></div>
                    <p class="score-label" id="scoreLabel">Niveau</p>
                    <p class="score-description" id="scoreDescription"></p>
                    <div class="dic-scores">
                        <div class="dic-score-item"><div class="label">üü¢ Disponibilit√©</div><div class="value" id="dicDisp">0%</div></div>
                        <div class="dic-score-item"><div class="label">üîµ Int√©grit√©</div><div class="value" id="dicInt">0%</div></div>
                        <div class="dic-score-item"><div class="label">üü£ Confidentialit√©</div><div class="value" id="dicConf">0%</div></div>
                    </div>
                </div>
                <div class="download-section"><button class="btn btn-accent" onclick="downloadPDF()">üìÑ T√©l√©charger mon rapport PDF</button><button class="btn btn-secondary" onclick="location.reload()">üîÑ Nouveau diagnostic</button></div>
                <div class="chart-container"><h3>üìä Analyse par cat√©gorie</h3><canvas id="radarChart"></canvas></div>
                <div class="category-scores" id="categoryScores"></div>
                <div class="solutions-section"><h3>üõ†Ô∏è Solutions Progress Things adapt√©es</h3><div id="solutionsList"></div></div>
                <div class="recommendations"><h3>üìã Recommandations prioritaires</h3><div id="recommendationsList"></div></div>
                <div class="results-cta"><h3>Besoin d'un accompagnement personnalis√© ?</h3><p>Nos experts peuvent vous aider √† mettre en ≈ìuvre ces recommandations.</p><a href="https://www.progressthings.com" target="_blank" class="btn" style="background:var(--primary);color:var(--white)">Contacter Progress Things ‚Üí</a><p style="margin-top:1rem;font-size:.8rem">üìß technique.bf@progressthings.com</p></div>
            </div>
        </section>
    </main>

    <div class="toast" id="toast"><span id="toastMessage"></span></div>
    <footer><p style="font-size:1.1rem;font-weight:600">Progi<span style="color:#00D4AA">Check</span></p><p>by <a href="https://www.progressthings.com">Progress Things</a></p><p>¬© 2024 ‚Äî Diagnostic gratuit</p><p class="footer-tagline">Let's do it together</p></footer>

<script>
const EMAILJS_PUBLIC_KEY = "LF6930gGEBQZK63sJ";
const EMAILJS_SERVICE_ID = "service_y7puafd";
const EMAILJS_TEMPLATE_ID = "template_o67tdos";

document.getElementById('consentCheck').addEventListener('change', function() { document.getElementById('consentBtn').disabled = !this.checked; });
function acceptConsent() { document.getElementById('consentModal').classList.add('hidden'); localStorage.setItem('progicheck_consent', 'true'); }
if (localStorage.getItem('progicheck_consent') === 'true') document.getElementById('consentModal').classList.add('hidden');
function startDiagnostic() { showSection('lead-form'); }

const categories = [
    { id:'infrastructure', name:'Infrastructure IT', icon:'üñ•Ô∏è', pdfName:'Infrastructure IT', questions:[
        { text:"Quel est l'√©tat de vos √©quipements informatiques ?", dic:"Disponibilit√©", options:[{text:"Tr√®s anciens (+7 ans), pannes fr√©quentes",score:0},{text:"Anciens (5-7 ans), quelques probl√®mes",score:1},{text:"Corrects (3-5 ans)",score:2},{text:"R√©cents (-3 ans), performants",score:3}]},
        { text:"Comment est organis√© votre r√©seau ?", dic:"Disponibilit√©", options:[{text:"Pas de r√©seau structur√©",score:0},{text:"Basique sans documentation",score:1},{text:"Structur√© avec switch/routeur",score:2},{text:"Segment√©, document√©, monitoring",score:3}]},
        { text:"Avez-vous un contrat de maintenance ?", dic:"Disponibilit√©", options:[{text:"Non, on r√©pare quand √ßa casse",score:0},{text:"Technicien au besoin",score:1},{text:"Contrat curatif",score:2},{text:"Contrat pr√©ventif avec SLA",score:3}]}
    ]},
    { id:'cybersecurity', name:'Cybers√©curit√©', icon:'üîí', pdfName:'Cybersecurite', questions:[
        { text:"Quelle protection sur vos postes ?", dic:"Int√©grit√©", options:[{text:"Aucune ou antivirus expir√©",score:0},{text:"Antivirus gratuit",score:1},{text:"Antivirus payant partout",score:2},{text:"Solution EDR/XDR (ESET)",score:3}]},
        { text:"Comment g√©rez-vous les sauvegardes ?", dic:"Int√©grit√©", options:[{text:"Pas de sauvegarde",score:0},{text:"Manuelle (cl√© USB)",score:1},{text:"Automatique locale",score:2},{text:"3-2-1 (local + cloud + test)",score:3}]},
        { text:"Sensibilisation au phishing ?", dic:"Confidentialit√©", options:[{text:"Jamais",score:0},{text:"Consignes informelles",score:1},{text:"Formation ponctuelle",score:2},{text:"Programme r√©gulier + tests",score:3}]}
    ]},
    { id:'physical_security', name:'S√©curit√© Physique', icon:'üìπ', pdfName:'Securite Physique', questions:[
        { text:"Syst√®me de vid√©osurveillance ?", dic:"Confidentialit√©", options:[{text:"Non",score:0},{text:"Cam√©ras non fonctionnelles",score:1},{text:"Cam√©ras + enregistrement local",score:2},{text:"IP + stockage s√©curis√©",score:3}]},
        { text:"Contr√¥le d'acc√®s aux locaux ?", dic:"Confidentialit√©", options:[{text:"Portes ouvertes",score:0},{text:"Cl√©s physiques",score:1},{text:"Badges/codes",score:2},{text:"Badges + tra√ßabilit√©",score:3}]},
        { text:"Syst√®me d'alarme ?", dic:"Disponibilit√©", options:[{text:"Non",score:0},{text:"Basique non connect√©e",score:1},{text:"Connect√©e + notification",score:2},{text:"T√©l√©surveillance 24/7",score:3}]}
    ]},
    { id:'continuity', name:'Continuit√©', icon:'‚ö°', pdfName:'Continuite', questions:[
        { text:"Protection coupures √©lectriques ?", dic:"Disponibilit√©", options:[{text:"Aucune",score:0},{text:"Quelques onduleurs",score:1},{text:"Onduleurs critiques",score:2},{text:"Central + groupe √©lectrog√®ne",score:3}]},
        { text:"Autonomie en cas de coupure ?", dic:"Disponibilit√©", options:[{text:"Aucune",score:0},{text:"<10 min",score:1},{text:"10-30 min",score:2},{text:"+30 min",score:3}]},
        { text:"Plan de continuit√© (PCA) ?", dic:"Disponibilit√©", options:[{text:"Non",score:0},{text:"R√©flexions informelles",score:1},{text:"Proc√©dures basiques",score:2},{text:"PCA test√© r√©guli√®rement",score:3}]}
    ]},
    { id:'data_recovery', name:'Donn√©es & Reprise', icon:'üíæ', pdfName:'Donnees Reprise', questions:[
        { text:"Stockage donn√©es critiques ?", dic:"Int√©grit√©", options:[{text:"Fichiers dispers√©s",score:0},{text:"Dossiers partag√©s sans organisation",score:1},{text:"Serveur/NAS centralis√©",score:2},{text:"BDD/ERP + acc√®s contr√¥l√©",score:3}]},
        { text:"Plan de reprise (PRA) ?", dic:"Disponibilit√©", options:[{text:"Non",score:0},{text:"Id√©e g√©n√©rale",score:1},{text:"Proc√©dures non test√©es",score:2},{text:"PRA test√©",score:3}]},
        { text:"Temps de reprise apr√®s panne ?", dic:"Disponibilit√©", options:[{text:"Jours/semaines",score:0},{text:"1-2 jours",score:1},{text:"Quelques heures",score:2},{text:"<1h, RTO/RPO d√©finis",score:3}]}
    ]},
    { id:'collaboration', name:'Collaboration', icon:'üë•', pdfName:'Collaboration', questions:[
        { text:"Messagerie professionnelle ?", dic:"Confidentialit√©", options:[{text:"Gmail/Yahoo perso",score:0},{text:"@gmail travail",score:1},{text:"Email pro basique",score:2},{text:"M365 / Google Workspace",score:3}]},
        { text:"Partage de fichiers ?", dic:"Int√©grit√©", options:[{text:"Cl√©s USB",score:0},{text:"WhatsApp/WeTransfer",score:1},{text:"Serveur/Drive basique",score:2},{text:"OneDrive/SharePoint + droits",score:3}]},
        { text:"Outils communication √©quipe ?", dic:"Disponibilit√©", options:[{text:"T√©l√©phone/SMS",score:0},{text:"WhatsApp travail",score:1},{text:"Zoom/Meet occasionnel",score:2},{text:"Teams/Slack quotidien",score:3}]}
    ]},
    { id:'digital_presence', name:'Pr√©sence digitale', icon:'üåê', pdfName:'Presence digitale', questions:[
        { text:"Site web professionnel ?", dic:"Disponibilit√©", options:[{text:"Non",score:0},{text:"Facebook uniquement",score:1},{text:"Site vitrine basique",score:2},{text:"Site pro, responsive, √† jour",score:3}]},
        { text:"R√©seaux sociaux ?", dic:"Disponibilit√©", options:[{text:"Aucune pr√©sence",score:0},{text:"Comptes inactifs",score:1},{text:"Actif mais irr√©gulier",score:2},{text:"Strat√©gie r√©guli√®re",score:3}]},
        { text:"Contact en ligne ?", dic:"Disponibilit√©", options:[{text:"T√©l√©phone uniquement",score:0},{text:"Email visible",score:1},{text:"Formulaire contact",score:2},{text:"Multi-canaux",score:3}]}
    ]},
    { id:'skills', name:'Comp√©tences', icon:'üéì', pdfName:'Competences', questions:[
        { text:"Niveau IT des employ√©s ?", dic:"Int√©grit√©", options:[{text:"Tr√®s basique",score:0},{text:"Basique",score:1},{text:"Correct, autonomes",score:2},{text:"Bon niveau",score:3}]},
        { text:"Formations IT ?", dic:"Int√©grit√©", options:[{text:"Jamais",score:0},{text:"Tr√®s rarement",score:1},{text:"Occasionnellement",score:2},{text:"Plan r√©gulier",score:3}]},
        { text:"Support IT ?", dic:"Disponibilit√©", options:[{text:"Chacun se d√©brouille",score:0},{text:"Coll√®gue 'qui s'y conna√Æt'",score:1},{text:"Prestataire externe",score:2},{text:"Support d√©di√© + tickets",score:3}]}
    ]},
    { id:'identity', name:'Identit√©s', icon:'üîë', pdfName:'Identites', questions:[
        { text:"Gestion comptes utilisateurs ?", dic:"Confidentialit√©", options:[{text:"Comptes partag√©s",score:0},{text:"Individuels sans proc√©dure",score:1},{text:"Proc√©dure cr√©ation/suppression",score:2},{text:"Annuaire centralis√© (AD)",score:3}]},
        { text:"Droits d'acc√®s ?", dic:"Confidentialit√©", options:[{text:"Tout le monde acc√®de √† tout",score:0},{text:"Restrictions informelles",score:1},{text:"Droits par service",score:2},{text:"Moindre privil√®ge + revue",score:3}]},
        { text:"MFA (double auth) ?", dic:"Confidentialit√©", options:[{text:"Non, inconnu",score:0},{text:"Non, mais connu",score:1},{text:"Sur certains comptes",score:2},{text:"Obligatoire partout",score:3}]}
    ]}
];

const ptSolutions = {
    infrastructure:{name:"Support IT Manag√©",desc:"Maintenance, supervision",icon:"üñ•Ô∏è"},
    cybersecurity:{name:"Cybers√©curit√© ESET",desc:"EDR, sauvegarde cloud",icon:"üîí"},
    physical_security:{name:"Vid√©osurveillance",desc:"Cam√©ras IP, contr√¥le acc√®s",icon:"üìπ"},
    continuity:{name:"Continuit√©",desc:"Onduleurs, groupe √©lectrog√®ne",icon:"‚ö°"},
    data_recovery:{name:"Backup & Reprise",desc:"Sauvegarde 3-2-1, PRA",icon:"üíæ"},
    collaboration:{name:"Microsoft 365",desc:"Outlook, Teams, OneDrive",icon:"üë•"},
    digital_presence:{name:"Conseil Digital",desc:"Site web, r√©seaux sociaux",icon:"üåê"},
    skills:{name:"Formations IT",desc:"M365, cybers√©curit√©",icon:"üéì"},
    identity:{name:"Gestion identit√©s",desc:"Entra ID, SSO, MFA",icon:"üîë"}
};

const levelDescriptions = {
    beginner:{label:"üî¥ D√©butant",pdfLabel:"Debutant",desc:"Fort potentiel d'am√©lioration."},
    developing:{label:"üü† En d√©veloppement",pdfLabel:"En developpement",desc:"Bases pos√©es, √† structurer."},
    intermediate:{label:"üü° Interm√©diaire",pdfLabel:"Intermediaire",desc:"Bonne maturit√©."},
    advanced:{label:"üü¢ Avanc√©",pdfLabel:"Avance",desc:"IT bien structur√©e."},
    expert:{label:"üèÜ Expert",pdfLabel:"Expert",desc:"Excellente maturit√©!"}
};

let currentQuestionIndex = 0, answers = [], leadData = {};
const totalQuestions = categories.reduce((s,c) => s + c.questions.length, 0);

function showToast(m, t='info') { const e=document.getElementById('toast'); document.getElementById('toastMessage').textContent=m; e.className='toast show '+t; setTimeout(()=>e.classList.remove('show'),3000); }
function showSection(id) { document.querySelectorAll('.section').forEach(s=>s.classList.remove('active')); document.getElementById(id).classList.add('active'); window.scrollTo(0,0); }

document.getElementById('leadForm').addEventListener('submit', function(e) {
    e.preventDefault();
    leadData = { companyName:document.getElementById('companyName').value, contactName:document.getElementById('contactName').value, contactEmail:document.getElementById('contactEmail').value, contactPhone:document.getElementById('contactPhone').value||'N/A', sector:document.getElementById('sector').value, employees:document.getElementById('employees').value, date:new Date().toLocaleDateString('fr-FR') };
    currentQuestionIndex=0; answers=new Array(totalQuestions).fill(null);
    document.getElementById('totalQuestions').textContent=totalQuestions;
    showSection('quiz'); displayQuestion();
});

function getQuestionData(idx) { let c=0; for(let cat of categories){for(let q of cat.questions){if(c===idx)return{category:cat,question:q};c++;}} return null; }

function displayQuestion() {
    const d=getQuestionData(currentQuestionIndex); if(!d)return;
    document.getElementById('categoryIcon').textContent=d.category.icon;
    document.getElementById('categoryName').textContent=d.category.name;
    document.getElementById('questionText').textContent=d.question.text;
    document.getElementById('questionDic').textContent=d.question.dic;
    const cont=document.getElementById('optionsContainer'); cont.innerHTML='';
    d.question.options.forEach((o,i)=>{ const div=document.createElement('div'); div.className='option'+(answers[currentQuestionIndex]===i?' selected':''); div.onclick=()=>selectOption(i); div.innerHTML='<div class="option-radio"></div><span class="option-text">'+o.text+'</span>'; cont.appendChild(div); });
    document.getElementById('progressBar').style.width=((currentQuestionIndex+1)/totalQuestions*100)+'%';
    document.getElementById('currentQuestion').textContent=currentQuestionIndex+1;
    document.getElementById('prevBtn').disabled=currentQuestionIndex===0;
    updateNextButton();
}

function selectOption(i) { answers[currentQuestionIndex]=i; document.querySelectorAll('.option').forEach((o,idx)=>o.classList.toggle('selected',idx===i)); updateNextButton(); }
function updateNextButton() { const b=document.getElementById('nextBtn'); b.disabled=answers[currentQuestionIndex]===null; b.textContent=currentQuestionIndex===totalQuestions-1?'Voir r√©sultats ‚Üí':'Suivant ‚Üí'; }
function nextQuestion() { if(answers[currentQuestionIndex]===null)return; if(currentQuestionIndex<totalQuestions-1){currentQuestionIndex++;displayQuestion();}else{calculateResults();} }
function previousQuestion() { if(currentQuestionIndex>0){currentQuestionIndex--;displayQuestion();} }

function calculateResults() {
    const catScores={}, dicScores={'Disponibilit√©':[],'Int√©grit√©':[],'Confidentialit√©':[]}; let qIdx=0;
    categories.forEach(cat=>{ let s=0,m=cat.questions.length*3; cat.questions.forEach(q=>{ if(answers[qIdx]!==null){const sc=q.options[answers[qIdx]].score;s+=sc;dicScores[q.dic].push(sc/3*100);} qIdx++; }); catScores[cat.id]={name:cat.name,pdfName:cat.pdfName,icon:cat.icon,score:Math.round(s/m*100)}; });
    const total=Math.round(Object.values(catScores).reduce((s,c)=>s+c.score,0)/categories.length);
    const dicFinal={ disponibilite:Math.round(dicScores['Disponibilit√©'].reduce((a,b)=>a+b,0)/dicScores['Disponibilit√©'].length), integrite:Math.round(dicScores['Int√©grit√©'].reduce((a,b)=>a+b,0)/dicScores['Int√©grit√©'].length), confidentialite:Math.round(dicScores['Confidentialit√©'].reduce((a,b)=>a+b,0)/dicScores['Confidentialit√©'].length) };
    displayResults(total,catScores,dicFinal); 
    sendEmail(total,catScores,dicFinal);
}

function getLevel(s) { if(s<30)return'beginner';if(s<50)return'developing';if(s<70)return'intermediate';if(s<90)return'advanced';return'expert'; }
function getInterp(id,s) { const i={infrastructure:{l:"Modernisation urgente",m:"Correcte",h:"Bonne"},cybersecurity:{l:"Tr√®s vuln√©rable",m:"Protection partielle",h:"Bonne s√©curit√©"},physical_security:{l:"Insuffisante",m:"Partielle",h:"Bonne"},continuity:{l:"Aucune r√©silience",m:"Partielle",h:"Bonne"},data_recovery:{l:"Risque perte donn√©es",m:"Backup partiel",h:"Bonne strat√©gie"},collaboration:{l:"Outils inadapt√©s",m:"Sous-utilis√©s",h:"Efficace"},digital_presence:{l:"Invisible",m:"Basique",h:"Bonne"},skills:{l:"Insuffisantes",m:"Correctes",h:"Comp√©tentes"},identity:{l:"Chaotique",m:"Partielle",h:"Bonne"}}; return i[id]?.[s<40?'l':s<70?'m':'h']||""; }

function sendEmail(score,catScores,dicFinal) {
    let allAnswers = '', qNum = 1, qIdx = 0;
    categories.forEach(cat => { allAnswers += '\n--- ' + cat.pdfName + ' (' + catScores[cat.id].score + '%) ---\n'; cat.questions.forEach(q => { const sel = answers[qIdx]; allAnswers += 'Q' + qNum + '. ' + q.text + '\n> ' + (sel !== null ? q.options[sel].text + ' (' + q.options[sel].score + '/3)' : 'N/A') + '\n'; qNum++; qIdx++; }); });
    const data = { subject: '[ProgiCheck] ' + leadData.companyName + ' - ' + score + '/100', company_name: leadData.companyName, contact_name: leadData.contactName, contact_email: leadData.contactEmail, contact_phone: leadData.contactPhone, sector: leadData.sector, employees: leadData.employees, version: 'GRATUIT', date: leadData.date, score: score, level: levelDescriptions[getLevel(score)].pdfLabel, dic_disponibilite: dicFinal.disponibilite + '%', dic_integrite: dicFinal.integrite + '%', dic_confidentialite: dicFinal.confidentialite + '%', category_scores: Object.entries(catScores).map(([id,c])=>c.pdfName+':'+c.score+'%').join(' | '), all_answers: allAnswers };
    if (EMAILJS_PUBLIC_KEY) { emailjs.init(EMAILJS_PUBLIC_KEY); emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, data).catch(e => console.error(e)); }
    console.log('DIAGNOSTIC:', data);
}

function displayResults(total,catScores,dicFinal) {
    showSection('results');
    document.getElementById('resultsCompanyName').textContent=leadData.companyName;
    document.getElementById('dicDisp').textContent=dicFinal.disponibilite+'%';
    document.getElementById('dicInt').textContent=dicFinal.integrite+'%';
    document.getElementById('dicConf').textContent=dicFinal.confidentialite+'%';
    const circle=document.getElementById('scoreCircle'),val=document.getElementById('scoreValue'); let cur=0;
    const anim=setInterval(()=>{if(cur>=total)clearInterval(anim);else{cur++;val.textContent=cur;circle.style.setProperty('--score',cur);}},20);
    const level=getLevel(total),levelInfo=levelDescriptions[level];
    document.getElementById('scoreLabel').textContent=levelInfo.label;
    document.getElementById('scoreDescription').textContent=levelInfo.desc;
    const scCont=document.getElementById('categoryScores'); scCont.innerHTML='';
    Object.entries(catScores).forEach(([id,c])=>{ const lv=c.score<40?'low':c.score<70?'medium':'high'; scCont.innerHTML+='<div class="category-score-card"><div class="category-score-header"><span class="category-score-name">'+c.icon+' '+c.name+'</span><span class="category-score-value '+lv+'">'+c.score+'%</span></div><div class="category-score-bar"><div class="category-score-fill '+lv+'" style="width:'+c.score+'%"></div></div><p class="category-score-desc">'+getInterp(id,c.score)+'</p></div>'; });
    createRadarChart(catScores); generateSolutions(catScores); generateRecs(catScores);
    window.resultsData={totalScore:total,categoryScores:catScores,dicFinal,level,levelInfo};
}

function createRadarChart(catScores) { const ctx=document.getElementById('radarChart').getContext('2d'); if(window.radarChartInstance)window.radarChartInstance.destroy(); window.radarChartInstance=new Chart(ctx,{type:'radar',data:{labels:Object.values(catScores).map(c=>c.pdfName),datasets:[{label:'Score',data:Object.values(catScores).map(c=>c.score),backgroundColor:'rgba(0,212,170,0.2)',borderColor:'#00D4AA',borderWidth:2,pointBackgroundColor:'#00D4AA'}]},options:{responsive:true,scales:{r:{beginAtZero:true,max:100,ticks:{stepSize:20}}},plugins:{legend:{display:false}}}}); }

function generateSolutions(catScores) { const cont=document.getElementById('solutionsList'); cont.innerHTML=''; Object.entries(catScores).sort((a,b)=>a[1].score-b[1].score).filter(([id,c])=>c.score<70).slice(0,4).forEach(([id])=>{ const sol=ptSolutions[id]; if(sol)cont.innerHTML+='<div class="solution-card"><div class="solution-header"><div class="solution-icon">'+sol.icon+'</div><div class="solution-title">'+sol.name+'</div></div><div class="solution-description">'+sol.desc+'</div></div>'; }); if(!cont.innerHTML)cont.innerHTML='<div class="solution-card"><div class="solution-header"><div class="solution-icon">üèÜ</div><div class="solution-title">F√©licitations!</div></div><div class="solution-description">Excellente maturit√©.</div></div>'; }

function generateRecs(catScores) { const cont=document.getElementById('recommendationsList'); cont.innerHTML=''; Object.entries(catScores).filter(([id,c])=>c.score<70).sort((a,b)=>a[1].score-b[1].score).slice(0,5).forEach(([id,c])=>{ const p=c.score<40?'high':'medium',sol=ptSolutions[id]; cont.innerHTML+='<div class="recommendation-item"><div class="recommendation-icon priority-'+p+'">'+c.icon+'</div><div class="recommendation-content"><h4>'+c.name+'</h4><p>'+getInterp(id,c.score)+'</p>'+(sol?'<div class="pt-solution">‚Üí '+sol.name+'</div>':'')+'</div></div>'; }); if(!cont.innerHTML)cont.innerHTML='<div class="recommendation-item"><div class="recommendation-icon" style="background:rgba(16,185,129,.1)">üèÜ</div><div class="recommendation-content"><h4>Excellent!</h4><p>Continuez ainsi.</p></div></div>'; }

function downloadPDF() {
    const d = window.resultsData; if (!d) return;
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const pw = doc.internal.pageSize.getWidth(), ph = doc.internal.pageSize.getHeight();
    let y = 15, pageNum = 1;
    
    const footer = () => { doc.setFillColor(26,26,26); doc.rect(0,ph-10,pw,10,'F'); doc.setTextColor(255,255,255); doc.setFontSize(7); doc.text('ProgiCheck - Progress Things - www.progressthings.com - Page '+pageNum, pw/2, ph-4, {align:'center'}); };
    const header = (t) => { doc.setFillColor(26,26,26); doc.rect(0,0,pw,12,'F'); doc.setTextColor(0,212,170); doc.setFontSize(9); doc.setFont('helvetica','bold'); doc.text('ProgiCheck', 10, 8); doc.setTextColor(150,150,150); doc.setFontSize(7); doc.text(' - '+leadData.companyName+' - '+t, 32, 8); };
    const newPage = (t) => { footer(); doc.addPage(); pageNum++; header(t); return 18; };
    const checkPage = (n,t) => { if(y+n>ph-15) y=newPage(t); };

    // PAGE 1 - RESUME
    doc.setFillColor(26,26,26); doc.rect(0,0,pw,25,'F');
    doc.setTextColor(0,212,170); doc.setFontSize(18); doc.setFont('helvetica','bold'); doc.text('ProgiCheck', 10, 15);
    doc.setTextColor(150,150,150); doc.setFontSize(8); doc.text(leadData.date, pw-10, 15, {align:'right'});
    
    y = 32;
    doc.setTextColor(26,26,26); doc.setFontSize(14); doc.setFont('helvetica','bold'); doc.text('RAPPORT DE MATURITE NUMERIQUE', pw/2, y, {align:'center'});
    y += 7; doc.setTextColor(0,212,170); doc.setFontSize(12); doc.text(leadData.companyName, pw/2, y, {align:'center'});
    y += 5; doc.setTextColor(100,100,100); doc.setFontSize(8); doc.setFont('helvetica','normal'); doc.text(leadData.sector+' | '+leadData.employees+' employes | '+leadData.contactEmail, pw/2, y, {align:'center'});
    
    y += 10;
    doc.setFillColor(26,26,26); doc.roundedRect(25,y,pw-50,30,4,4,'F');
    doc.setTextColor(0,212,170); doc.setFontSize(28); doc.setFont('helvetica','bold'); doc.text(d.totalScore+'/100', pw/2, y+15, {align:'center'});
    doc.setTextColor(255,255,255); doc.setFontSize(10); doc.text(d.levelInfo.pdfLabel, pw/2, y+24, {align:'center'});
    y += 36;
    
    doc.setFillColor(240,240,240); doc.roundedRect(10,y,pw-20,10,2,2,'F');
    doc.setTextColor(26,26,26); doc.setFontSize(8); doc.setFont('helvetica','bold'); doc.text('DIC:', 15, y+7);
    doc.setTextColor(16,185,129); doc.text('D:'+d.dicFinal.disponibilite+'%', 30, y+7);
    doc.setTextColor(59,130,246); doc.text('I:'+d.dicFinal.integrite+'%', 55, y+7);
    doc.setTextColor(139,92,246); doc.text('C:'+d.dicFinal.confidentialite+'%', 75, y+7);
    y += 15;
    
    doc.setTextColor(26,26,26); doc.setFontSize(10); doc.setFont('helvetica','bold'); doc.text('SCORES PAR CATEGORIE', 10, y); y += 6;
    Object.entries(d.categoryScores).forEach(([id,c]) => {
        const col = c.score<40?[239,68,68]:c.score<70?[245,158,11]:[16,185,129];
        doc.setFillColor(230,230,230); doc.roundedRect(10,y,pw-20,8,2,2,'F');
        doc.setFillColor(...col); const bw=(pw-20)*c.score/100; if(bw>2)doc.roundedRect(10,y,bw,8,2,2,'F');
        doc.setTextColor(40,40,40); doc.setFontSize(7); doc.setFont('helvetica','bold'); doc.text(c.pdfName,13,y+5); doc.text(c.score+'%',pw-13,y+5,{align:'right'});
        y += 10;
    });
    
    // PAGE 2 - RECOMMANDATIONS
    y = newPage('Recommandations');
    doc.setTextColor(26,26,26); doc.setFontSize(11); doc.setFont('helvetica','bold'); doc.text('RECOMMANDATIONS PRIORITAIRES', 10, y); y += 8;
    Object.entries(d.categoryScores).sort((a,b)=>a[1].score-b[1].score).forEach(([id,c]) => {
        checkPage(18,'Recommandations');
        const col = c.score<40?[239,68,68]:c.score<70?[245,158,11]:[16,185,129];
        const prio = c.score<40?'URGENT':c.score<70?'A AMELIORER':'BON';
        doc.setFillColor(248,248,248); doc.roundedRect(10,y,pw-20,14,2,2,'F');
        doc.setFillColor(...col); doc.roundedRect(10,y,3,14,1,1,'F');
        doc.setTextColor(26,26,26); doc.setFontSize(8); doc.setFont('helvetica','bold'); doc.text(c.pdfName,16,y+5);
        doc.setFillColor(...col); doc.roundedRect(pw-45,y+1,22,5,1,1,'F'); doc.setTextColor(255,255,255); doc.setFontSize(5); doc.text(prio,pw-34,y+4.5,{align:'center'});
        doc.setTextColor(...col); doc.setFontSize(9); doc.text(c.score+'%',pw-15,y+5,{align:'right'});
        doc.setTextColor(80,80,80); doc.setFontSize(6); doc.setFont('helvetica','normal'); doc.text(getInterp(id,c.score),16,y+11);
        y += 16;
    });
    
    // CTA
    checkPage(30, 'Recommandations'); y+=5;
    doc.setFillColor(0,212,170); doc.roundedRect(10,y,pw-20,25,3,3,'F');
    doc.setTextColor(26,26,26); doc.setFontSize(10); doc.setFont('helvetica','bold');
    doc.text('Besoin d\'accompagnement ?',pw/2,y+8,{align:'center'});
    doc.setFontSize(8); doc.setFont('helvetica','normal');
    doc.text('Progress Things peut vous aider a mettre en oeuvre ces recommandations.',pw/2,y+14,{align:'center'});
    doc.setFont('helvetica','bold');
    doc.text('www.progressthings.com | technique.bf@progressthings.com',pw/2,y+21,{align:'center'});
    
    footer();
    doc.save('ProgiCheck_'+leadData.companyName.replace(/[^a-zA-Z0-9]/g,'_')+'.pdf');
    showToast('PDF telecharge!','success');
}
</script>
</body>
</html>
