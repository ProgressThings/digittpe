<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DigiPME by Progress Things ‚Äî Diagnostic Maturit√© Num√©rique TPE/PME</title>
    <meta name="description" content="√âvaluez la maturit√© num√©rique de votre entreprise en 10 minutes. Diagnostic complet bas√© sur les crit√®res DIC.">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        :root{--primary:#1a1a1a;--secondary:#2d2d2d;--accent:#00D4AA;--accent-dark:#00B894;--white:#fff;--gray-100:#f7f7f7;--gray-200:#e5e5e5;--gray-300:#d4d4d4;--gray-400:#a3a3a3;--gray-500:#737373;--danger:#ef4444;--warning:#f59e0b;--success:#10b981;--pro-gold:#FFD700}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Inter',sans-serif;background:var(--gray-100);color:var(--primary);line-height:1.6}
        .consent-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;display:flex;align-items:center;justify-content:center;padding:1rem}
        .consent-overlay.hidden{display:none}
        .consent-modal{background:var(--white);border-radius:20px;max-width:520px;width:100%;padding:2rem;animation:fadeIn .3s ease}
        .consent-modal h2{font-family:'Space Grotesk',sans-serif;font-size:1.5rem;margin-bottom:1rem;color:var(--primary);text-align:center}
        .consent-modal>p{color:var(--gray-500);font-size:.9rem;margin-bottom:1rem}
        .consent-modal ul{margin:1rem 0;padding-left:1.5rem;color:var(--gray-500);font-size:.85rem}
        .consent-modal ul li{margin-bottom:.5rem}
        .consent-checkbox{display:flex;align-items:flex-start;gap:.75rem;margin:1.5rem 0;padding:1rem;background:var(--gray-100);border-radius:10px}
        .consent-checkbox input{width:20px;height:20px;margin-top:2px;accent-color:var(--accent);cursor:pointer;flex-shrink:0}
        .consent-checkbox label{font-size:.85rem;color:var(--gray-500);cursor:pointer}
        .consent-btn{width:100%;padding:1rem;border-radius:50px;font-size:1rem;font-weight:600;cursor:pointer;border:none;transition:all .3s ease}
        .consent-btn:disabled{background:var(--gray-300);color:var(--gray-500);cursor:not-allowed}
        .consent-btn:not(:disabled){background:var(--accent);color:var(--primary)}
        .consent-btn:not(:disabled):hover{background:var(--accent-dark)}
        header{background:var(--primary);padding:1rem 2rem;position:fixed;top:0;left:0;right:0;z-index:1000;display:flex;justify-content:space-between;align-items:center}
        .logo{display:flex;align-items:center;gap:.75rem}
        .logo-icon{width:40px;height:40px}
        .logo-text{color:var(--white);font-family:'Space Grotesk',sans-serif;font-weight:700;font-size:1.25rem}
        .logo-text span{color:var(--accent)}
        .header-pt{color:var(--gray-400);font-size:.8rem;text-decoration:none;transition:color .3s}
        .header-pt:hover{color:var(--white)}
        .header-pt strong{color:var(--accent)}
        main{margin-top:72px;min-height:calc(100vh - 72px)}
        .container{max-width:900px;margin:0 auto;padding:2rem 1rem}
        .section{display:none;animation:fadeIn .4s ease}
        .section.active{display:block}
        @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .hero{text-align:center;padding:3rem 1rem}
        .hero-badge{display:inline-block;background:var(--accent);color:var(--primary);padding:.5rem 1rem;border-radius:50px;font-size:.875rem;font-weight:600;margin-bottom:1.5rem}
        .hero h1{font-family:'Space Grotesk',sans-serif;font-size:2.5rem;font-weight:700;line-height:1.2;margin-bottom:1rem}
        .hero h1 span{color:var(--accent-dark)}
        .hero-subtitle{font-size:1.1rem;color:var(--gray-500);max-width:600px;margin:0 auto 2rem}
        .hero-cta{display:inline-flex;align-items:center;gap:.75rem;background:var(--primary);color:var(--white);padding:1rem 2rem;border-radius:50px;font-size:1.1rem;font-weight:600;cursor:pointer;border:none;transition:all .3s ease;text-decoration:none}
        .hero-cta:hover{background:var(--secondary);transform:translateY(-2px);box-shadow:0 10px 30px rgba(0,0,0,.2)}
        .hero-cta-secondary{background:var(--white);color:var(--primary);border:2px solid var(--gray-300)}
        .hero-cta-secondary:hover{border-color:var(--primary);background:var(--white)}
        .hero-buttons{display:flex;flex-wrap:wrap;justify-content:center;gap:1rem;margin-top:2rem}
        .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-top:3rem}
        .feature-card{background:var(--white);padding:1.25rem;border-radius:16px;border:1px solid var(--gray-200);text-align:center;transition:all .3s ease}
        .feature-card:hover{border-color:var(--accent);transform:translateY(-4px)}
        .feature-icon{font-size:2rem;margin-bottom:.5rem}
        .feature-card h3{font-family:'Space Grotesk',sans-serif;font-size:1rem;font-weight:600;margin-bottom:.25rem}
        .feature-card p{color:var(--gray-500);font-size:.8rem}
        .dic-banner{background:linear-gradient(135deg,var(--primary),var(--secondary));padding:2rem;border-radius:20px;margin-top:2rem;color:var(--white)}
        .dic-banner h3{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;margin-bottom:1rem;text-align:center}
        .dic-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}
        .dic-item{text-align:center;padding:1rem;background:rgba(255,255,255,.05);border-radius:12px}
        .dic-item .icon{font-size:1.5rem;margin-bottom:.5rem}
        .dic-item h4{font-size:.9rem;margin-bottom:.25rem;color:var(--accent)}
        .dic-item p{font-size:.75rem;color:var(--gray-400)}
        .pt-banner{background:var(--accent);padding:1.5rem;border-radius:16px;margin-top:2rem;text-align:center;color:var(--primary)}
        .pt-banner p{font-weight:500;margin-bottom:.25rem}
        .pt-banner .tagline{font-weight:700}
        .categories-section h2{font-family:'Space Grotesk',sans-serif;font-size:1.75rem;text-align:center;margin-bottom:.5rem}
        .categories-section .subtitle{text-align:center;color:var(--gray-500);margin-bottom:2rem}
        .category-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem}
        .category-card{background:var(--white);border-radius:16px;padding:1.25rem;border:1px solid var(--gray-200);display:flex;gap:1rem;align-items:flex-start;transition:all .3s}
        .category-card:hover{border-color:var(--accent)}
        .category-card-icon{width:50px;height:50px;background:linear-gradient(135deg,var(--accent),var(--accent-dark));border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;flex-shrink:0}
        .category-card-content h3{font-family:'Space Grotesk',sans-serif;font-size:.95rem;margin-bottom:.25rem}
        .category-card-content p{color:var(--gray-500);font-size:.8rem}
        .pricing-section h2{font-family:'Space Grotesk',sans-serif;font-size:1.75rem;text-align:center;margin-bottom:.5rem}
        .pricing-section .subtitle{text-align:center;color:var(--gray-500);margin-bottom:2rem}
        .pricing-grid{display:grid;grid-template-columns:1fr;gap:1.5rem}
        @media(min-width:768px){.pricing-grid{grid-template-columns:1fr 1fr}.dic-grid{grid-template-columns:repeat(3,1fr)}}
        @media(max-width:767px){.dic-grid{grid-template-columns:1fr}}
        .pricing-card{background:var(--white);border-radius:20px;padding:2rem;border:2px solid var(--gray-200);position:relative;transition:all .3s ease}
        .pricing-card:hover{transform:translateY(-4px);box-shadow:0 10px 40px rgba(0,0,0,.1)}
        .pricing-card.pro{border-color:var(--pro-gold);background:linear-gradient(180deg,#FFFEF5 0%,#FFF 100%)}
        .pricing-card.pro::before{content:'‚≠ê RECOMMAND√â';position:absolute;top:-12px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#FFD700,#FFA500);color:var(--primary);padding:.35rem 1rem;border-radius:50px;font-size:.7rem;font-weight:700}
        .pricing-header{text-align:center;margin-bottom:1.5rem;padding-bottom:1.5rem;border-bottom:1px solid var(--gray-200)}
        .pricing-name{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;font-weight:600;margin-bottom:.5rem}
        .pricing-price{font-family:'Space Grotesk',sans-serif;font-size:2.5rem;font-weight:700;color:var(--primary)}
        .pricing-price span{font-size:1rem;color:var(--gray-500);font-weight:400}
        .pricing-price.free{color:var(--accent-dark)}
        .pricing-desc{font-size:.875rem;color:var(--gray-500);margin-top:.5rem}
        .pricing-usd{font-size:1rem;color:var(--gray-400);font-weight:500;margin-top:.25rem}
        .pricing-features{list-style:none;margin-bottom:1.5rem}
        .pricing-features li{display:flex;align-items:flex-start;gap:.75rem;padding:.4rem 0;font-size:.85rem}
        .pricing-features li.included::before{content:'‚úì';color:var(--success);font-weight:700}
        .pricing-features li.excluded::before{content:'‚úó';color:var(--gray-400);font-weight:700}
        .pricing-features li.excluded{color:var(--gray-400)}
        .pricing-features li.highlight{background:rgba(0,212,170,.1);margin:0 -1rem;padding:.6rem 1rem;border-radius:8px}
        .pricing-cta{width:100%;padding:1rem;border-radius:50px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;border:none}
        .pricing-cta.free{background:var(--gray-200);color:var(--primary)}
        .pricing-cta.free:hover{background:var(--gray-300)}
        .pricing-cta.pro{background:linear-gradient(135deg,#FFD700,#FFA500);color:var(--primary)}
        .pricing-cta.pro:hover{transform:scale(1.02);box-shadow:0 5px 20px rgba(255,215,0,.4)}
        .payment-info{background:var(--gray-100);border-radius:12px;padding:1.5rem;margin-top:2rem;text-align:center}
        .payment-info h4{font-family:'Space Grotesk',sans-serif;margin-bottom:1rem}
        .payment-methods{display:flex;justify-content:center;gap:.75rem;flex-wrap:wrap;margin-bottom:1rem}
        .payment-method{background:var(--white);padding:.4rem .8rem;border-radius:8px;font-weight:600;font-size:.85rem;border:1px solid var(--gray-200)}
        .form-section{max-width:500px;margin:0 auto}
        .form-header{text-align:center;margin-bottom:2rem}
        .form-header h2{font-family:'Space Grotesk',sans-serif;font-size:1.75rem;margin-bottom:.5rem}
        .form-header p{color:var(--gray-500)}
        .form-card{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200)}
        .form-group{margin-bottom:1.25rem}
        .form-group label{display:block;font-weight:500;margin-bottom:.5rem;font-size:.875rem}
        .form-group .required{color:var(--danger)}
        .form-group input,.form-group select{width:100%;padding:.875rem 1rem;border:1px solid var(--gray-300);border-radius:10px;font-size:1rem;font-family:'Inter',sans-serif}
        .form-group input:focus,.form-group select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,212,170,.1)}
        .form-privacy{font-size:.75rem;color:var(--gray-500);text-align:center;margin-top:1rem}
        .version-indicator{text-align:center;margin-bottom:1.5rem}
        .version-badge{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem 1rem;border-radius:50px;font-size:.875rem;font-weight:600}
        .version-badge.free{background:var(--gray-200);color:var(--primary)}
        .version-badge.pro{background:linear-gradient(135deg,#FFD700,#FFA500);color:var(--primary)}
        .quiz-header{text-align:center;margin-bottom:2rem}
        .quiz-header h2{font-family:'Space Grotesk',sans-serif;font-size:1.5rem;margin-bottom:.5rem}
        .progress-container{background:var(--gray-200);height:8px;border-radius:4px;overflow:hidden;margin-bottom:.5rem}
        .progress-bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-dark));border-radius:4px;transition:width .4s ease}
        .progress-text{font-size:.875rem;color:var(--gray-500)}
        .category-indicator{display:inline-flex;align-items:center;gap:.5rem;background:var(--primary);color:var(--white);padding:.5rem 1rem;border-radius:50px;font-size:.875rem;font-weight:500;margin-bottom:1.5rem}
        .question-card{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200)}
        .question-dic{display:inline-block;font-size:.7rem;padding:.25rem .6rem;border-radius:4px;margin-bottom:.75rem;background:var(--gray-100);color:var(--gray-500)}
        .question-text{font-family:'Space Grotesk',sans-serif;font-size:1.2rem;font-weight:600;margin-bottom:1.5rem;line-height:1.4}
        .options{display:flex;flex-direction:column;gap:.75rem}
        .option{display:flex;align-items:center;padding:1rem 1.25rem;border:2px solid var(--gray-200);border-radius:12px;cursor:pointer;transition:all .2s ease}
        .option:hover{border-color:var(--accent);background:rgba(0,212,170,.05)}
        .option.selected{border-color:var(--accent);background:rgba(0,212,170,.1)}
        .option-radio{width:20px;height:20px;border:2px solid var(--gray-300);border-radius:50%;margin-right:1rem;display:flex;align-items:center;justify-content:center;flex-shrink:0}
        .option.selected .option-radio{border-color:var(--accent);background:var(--accent)}
        .option.selected .option-radio::after{content:'';width:8px;height:8px;background:var(--white);border-radius:50%}
        .option-text{font-size:.9rem}
        .nav-buttons{display:flex;justify-content:space-between;margin-top:2rem;gap:1rem}
        .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.875rem 1.5rem;border-radius:50px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;border:none;text-decoration:none}
        .btn-primary{background:var(--primary);color:var(--white)}
        .btn-primary:hover{background:var(--secondary);transform:translateY(-2px)}
        .btn-primary:disabled{background:var(--gray-300);cursor:not-allowed;transform:none}
        .btn-secondary{background:var(--white);color:var(--primary);border:1px solid var(--gray-300)}
        .btn-secondary:hover{border-color:var(--primary)}
        .btn-accent{background:var(--accent);color:var(--primary)}
        .btn-accent:hover{background:var(--accent-dark)}
        .results-header{text-align:center;margin-bottom:2rem}
        .results-header h2{font-family:'Space Grotesk',sans-serif;font-size:2rem;margin-bottom:.5rem}
        .score-display{background:var(--primary);color:var(--white);padding:2.5rem 2rem;border-radius:24px;text-align:center;margin-bottom:2rem}
        .score-circle{width:150px;height:150px;border-radius:50%;background:conic-gradient(var(--accent) calc(var(--score) * 1%),var(--secondary) 0);display:flex;align-items:center;justify-content:center;margin:0 auto 1.5rem;position:relative}
        .score-circle::before{content:'';position:absolute;width:120px;height:120px;background:var(--primary);border-radius:50%}
        .score-value{position:relative;z-index:1;font-family:'Space Grotesk',sans-serif;font-size:2.5rem;font-weight:700}
        .score-value span{font-size:1.25rem;color:var(--gray-400)}
        .score-label{font-size:1.25rem;font-weight:600;margin-bottom:.5rem}
        .score-description{color:var(--gray-400);max-width:400px;margin:0 auto;font-size:.9rem}
        .dic-scores{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid var(--secondary)}
        .dic-score-item{text-align:center}
        .dic-score-item .label{font-size:.7rem;color:var(--gray-400);margin-bottom:.25rem}
        .dic-score-item .value{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;font-weight:700;color:var(--accent)}
        .chart-container{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200);margin-bottom:2rem}
        .chart-container h3{font-family:'Space Grotesk',sans-serif;font-size:1.25rem;margin-bottom:1.5rem;text-align:center}
        #radarChart{max-height:320px}
        .category-scores{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1rem;margin-bottom:2rem}
        .category-score-card{background:var(--white);padding:1.25rem;border-radius:16px;border:1px solid var(--gray-200)}
        .category-score-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem}
        .category-score-name{font-weight:600;font-size:.9rem}
        .category-score-value{font-family:'Space Grotesk',sans-serif;font-weight:700;font-size:1.1rem}
        .category-score-value.low{color:var(--danger)}
        .category-score-value.medium{color:var(--warning)}
        .category-score-value.high{color:var(--success)}
        .category-score-bar{height:8px;background:var(--gray-200);border-radius:4px;overflow:hidden;margin-bottom:.5rem}
        .category-score-fill{height:100%;border-radius:4px;transition:width .6s ease}
        .category-score-fill.low{background:var(--danger)}
        .category-score-fill.medium{background:var(--warning)}
        .category-score-fill.high{background:var(--success)}
        .category-score-desc{font-size:.75rem;color:var(--gray-500)}
        .pro-upsell{background:linear-gradient(135deg,#1a1a1a,#2d2d2d);border:2px solid var(--pro-gold);border-radius:20px;padding:2rem;margin-bottom:2rem;text-align:center;color:var(--white);position:relative;overflow:hidden}
        .pro-upsell::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(135deg,#FFD700,#FFA500)}
        .pro-upsell h3{font-family:'Space Grotesk',sans-serif;font-size:1.4rem;margin-bottom:.5rem}
        .pro-upsell .price{font-size:2rem;font-weight:700;color:var(--pro-gold);margin:1rem 0}
        .pro-upsell .price span{font-size:1rem;color:var(--gray-400)}
        .pro-upsell .benefits{text-align:left;max-width:400px;margin:1rem auto;list-style:none}
        .pro-upsell .benefits li{display:flex;align-items:flex-start;gap:.5rem;margin-bottom:.5rem;font-size:.85rem;color:var(--gray-300)}
        .pro-upsell .benefits li::before{content:'‚úì';color:var(--pro-gold);font-weight:700}
        .pro-upsell .payment-methods-pro{display:flex;justify-content:center;gap:.5rem;flex-wrap:wrap;margin:1rem 0}
        .pro-upsell .payment-methods-pro span{background:rgba(255,255,255,.1);padding:.3rem .6rem;border-radius:6px;font-size:.75rem}
        .solutions-section{background:linear-gradient(135deg,#1a1a1a,#2d2d2d);padding:2rem;border-radius:20px;margin-bottom:2rem;color:var(--white)}
        .solutions-section h3{font-family:'Space Grotesk',sans-serif;font-size:1.2rem;margin-bottom:1rem}
        .solutions-section>p{color:var(--gray-400);margin-bottom:1.5rem;font-size:.9rem}
        .solution-card{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:1.25rem;margin-bottom:1rem}
        .solution-header{display:flex;align-items:center;gap:.75rem;margin-bottom:.5rem}
        .solution-icon{width:36px;height:36px;background:var(--accent);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:1.1rem}
        .solution-title{font-weight:600;font-size:.95rem}
        .solution-description{color:var(--gray-400);font-size:.8rem}
        .solution-tag{display:inline-block;background:var(--accent);color:var(--primary);padding:.2rem .6rem;border-radius:50px;font-size:.7rem;font-weight:600;margin-top:.5rem}
        .recommendations{background:var(--white);padding:2rem;border-radius:20px;border:1px solid var(--gray-200);margin-bottom:2rem}
        .recommendations h3{font-family:'Space Grotesk',sans-serif;font-size:1.2rem;margin-bottom:1.5rem}
        .recommendation-item{display:flex;gap:1rem;padding:1rem 0;border-bottom:1px solid var(--gray-200)}
        .recommendation-item:last-child{border-bottom:none}
        .recommendation-icon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:1.1rem}
        .recommendation-icon.priority-high{background:rgba(239,68,68,.1)}
        .recommendation-icon.priority-medium{background:rgba(245,158,11,.1)}
        .recommendation-content h4{font-size:.9rem;font-weight:600;margin-bottom:.25rem}
        .recommendation-content p{font-size:.8rem;color:var(--gray-500)}
        .recommendation-content .pt-solution{color:var(--accent-dark);font-size:.75rem;font-weight:600;margin-top:.5rem}
        .results-cta{background:linear-gradient(135deg,var(--accent),var(--accent-dark));padding:2rem;border-radius:20px;text-align:center;color:var(--primary)}
        .results-cta h3{font-family:'Space Grotesk',sans-serif;font-size:1.4rem;margin-bottom:.5rem}
        .results-cta p{color:var(--secondary);margin-bottom:1rem;font-size:.9rem}
        .results-cta .btn-dark{background:var(--primary);color:var(--white)}
        .results-cta .contact-info{margin-top:1rem;font-size:.85rem;color:var(--secondary)}
        .download-section{display:flex;justify-content:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}
        .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:var(--primary);color:var(--white);padding:1rem 1.5rem;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);z-index:2000;display:none;align-items:center;gap:.75rem}
        .toast.show{display:flex}
        .toast.success{background:var(--success)}
        .toast.error{background:var(--danger)}
        footer{background:var(--primary);color:var(--white);padding:2rem;text-align:center}
        footer p{color:var(--gray-400);font-size:.85rem;margin-bottom:.5rem}
        footer a{color:var(--accent);text-decoration:none}
        .footer-tagline{color:var(--accent);font-weight:600;margin-top:.75rem}
        @media(max-width:768px){.hero h1{font-size:2rem}.dic-scores{grid-template-columns:repeat(3,1fr)}}
    </style>
</head>
<body>
    <div class="consent-overlay" id="consentOverlay">
        <div class="consent-modal">
            <h2>üîí Protection de vos donn√©es</h2>
            <p>Bienvenue sur <strong>DigiPME</strong> ! Avant de commencer, voici comment nous utilisons vos donn√©es :</p>
            <ul>
                <li><strong>Finalit√© :</strong> G√©n√©rer votre rapport de maturit√© num√©rique et vous proposer des solutions adapt√©es.</li>
                <li><strong>Conservation :</strong> Vos donn√©es sont s√©curis√©es et jamais revendues √† des tiers.</li>
                <li><strong>Contact :</strong> Progress Things pourra vous contacter pour vous accompagner.</li>
                <li><strong>Droits :</strong> Demandez l'acc√®s, modification ou suppression de vos donn√©es √† technique.bf@progressthings.com</li>
            </ul>
            <div class="consent-checkbox">
                <input type="checkbox" id="consentCheck">
                <label for="consentCheck">J'accepte que mes donn√©es soient collect√©es et trait√©es par <strong>Progress Things</strong> conform√©ment √† cette politique. Je peux retirer mon consentement √† tout moment.</label>
            </div>
            <button class="consent-btn" id="consentBtn" disabled onclick="acceptConsent()">Accepter et continuer</button>
        </div>
    </div>

    <header>
        <div class="logo">
            <div class="logo-icon"><svg viewBox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="45" stroke="#00D4AA" stroke-width="3" fill="none"/><circle cx="50" cy="50" r="30" stroke="#00D4AA" stroke-width="2" fill="none"/><circle cx="50" cy="50" r="15" stroke="#00D4AA" stroke-width="2" fill="none"/><circle cx="50" cy="50" r="5" fill="#00D4AA"/></svg></div>
            <div class="logo-text">Digi<span>PME</span></div>
        </div>
        <a href="https://www.progressthings.com" target="_blank" class="header-pt">by <strong>Progress Things</strong></a>
    </header>

    <main>
        <section id="home" class="section active">
            <div class="container">
                <div class="hero">
                    <div class="hero-badge">üéØ Diagnostic complet en 9 cat√©gories</div>
                    <h1>√âvaluez la <span>maturit√© num√©rique</span> de votre entreprise</h1>
                    <p class="hero-subtitle">Un diagnostic professionnel bas√© sur les crit√®res DIC (Disponibilit√©, Int√©grit√©, Confidentialit√©) pour les TPE et PME africaines.</p>
                    <div class="hero-buttons">
                        <button class="hero-cta" onclick="showSection('pricing')">üöÄ Commencer le diagnostic</button>
                        <button class="hero-cta hero-cta-secondary" onclick="showSection('categories-info')">üìã Voir les 8 cat√©gories</button>
                    </div>
                    <div class="features">
                        <div class="feature-card"><div class="feature-icon">‚è±Ô∏è</div><h3>12 minutes</h3><p>27 questions cibl√©es</p></div>
                        <div class="feature-card"><div class="feature-icon">üìä</div><h3>9 cat√©gories</h3><p>Analyse compl√®te</p></div>
                        <div class="feature-card"><div class="feature-icon">üõ°Ô∏è</div><h3>Approche DIC</h3><p>M√©thodologie pro</p></div>
                        <div class="feature-card"><div class="feature-icon">üìÑ</div><h3>Rapport PDF</h3><p>Recommandations</p></div>
                    </div>
                    <div class="dic-banner">
                        <h3>üõ°Ô∏è M√©thodologie bas√©e sur les crit√®res DIC</h3>
                        <div class="dic-grid">
                            <div class="dic-item"><div class="icon">üü¢</div><h4>Disponibilit√©</h4><p>Vos syst√®mes sont-ils accessibles quand n√©cessaire ?</p></div>
                            <div class="dic-item"><div class="icon">üîµ</div><h4>Int√©grit√©</h4><p>Vos donn√©es sont-elles prot√©g√©es contre les modifications ?</p></div>
                            <div class="dic-item"><div class="icon">üü£</div><h4>Confidentialit√©</h4><p>Les acc√®s sont-ils limit√©s aux personnes autoris√©es ?</p></div>
                        </div>
                    </div>
                    <div class="pt-banner"><p>Un diagnostic d√©velopp√© par</p><div class="tagline">Progress Things ‚Äî Let's do it together</div></div>
                </div>
            </div>
        </section>

        <section id="categories-info" class="section">
            <div class="container">
                <div class="categories-section">
                    <h2>Les 9 cat√©gories √©valu√©es</h2>
                    <p class="subtitle">Un diagnostic couvrant tous les aspects de votre infrastructure num√©rique</p>
                    <div class="category-grid">
                        <div class="category-card"><div class="category-card-icon">üñ•Ô∏è</div><div class="category-card-content"><h3>1. Infrastructure IT</h3><p>√âquipements, r√©seau, maintenance</p></div></div>
                        <div class="category-card"><div class="category-card-icon">üîí</div><div class="category-card-content"><h3>2. Cybers√©curit√©</h3><p>Antivirus, sauvegardes, sensibilisation</p></div></div>
                        <div class="category-card"><div class="category-card-icon">üìπ</div><div class="category-card-content"><h3>3. S√©curit√© Physique</h3><p>Vid√©osurveillance, contr√¥le d'acc√®s, alarmes</p></div></div>
                        <div class="category-card"><div class="category-card-icon">‚ö°</div><div class="category-card-content"><h3>4. Continuit√© d'activit√©</h3><p>√ânergie, onduleurs, PCA</p></div></div>
                        <div class="category-card"><div class="category-card-icon">üíæ</div><div class="category-card-content"><h3>5. Donn√©es & Reprise</h3><p>BDD centralis√©e, backup, PRA, RTO/RPO</p></div></div>
                        <div class="category-card"><div class="category-card-icon">üë•</div><div class="category-card-content"><h3>6. Outils collaboratifs</h3><p>Messagerie, partage, visioconf√©rence</p></div></div>
                        <div class="category-card"><div class="category-card-icon">üåê</div><div class="category-card-content"><h3>7. Pr√©sence digitale</h3><p>Site web, r√©seaux sociaux</p></div></div>
                        <div class="category-card"><div class="category-card-icon">üéì</div><div class="category-card-content"><h3>8. Comp√©tences √©quipe</h3><p>Formations, support IT</p></div></div>
                        <div class="category-card"><div class="category-card-icon">üîë</div><div class="category-card-content"><h3>9. Gestion des identit√©s</h3><p>Comptes, droits, MFA</p></div></div>
                    </div>
                    <div class="nav-buttons" style="justify-content:center;margin-top:2rem"><button class="btn btn-secondary" onclick="showSection('home')">‚Üê Retour</button><button class="btn btn-primary" onclick="showSection('pricing')">Voir les offres ‚Üí</button></div>
                </div>
            </div>
        </section>

        <section id="pricing" class="section">
            <div class="container">
                <div class="pricing-section">
                    <h2>Choisissez votre formule</h2>
                    <p class="subtitle">Diagnostic adapt√© √† vos besoins</p>
                    <div class="pricing-grid">
                        <div class="pricing-card">
                            <div class="pricing-header"><div class="pricing-name">Diagnostic Gratuit</div><div class="pricing-price free">0 <span>XOF</span></div><div class="pricing-desc">√âvaluez votre niveau en 10 min</div></div>
                            <ul class="pricing-features"><li class="included">27 questions / 9 cat√©gories</li><li class="included">Score global + scores DIC</li><li class="included">Graphique radar</li><li class="included">Rapport PDF basique</li><li class="excluded">Rapport d√©taill√©</li><li class="excluded">Plan d'action 90 jours</li><li class="excluded">Accompagnement expert</li></ul>
                            <button class="pricing-cta free" onclick="selectPlan('free')">Commencer gratuitement</button>
                        </div>
                        <div class="pricing-card pro">
                            <div class="pricing-header"><div class="pricing-name">Diagnostic Pro ‚≠ê</div><div class="pricing-price">25 000 <span>XOF</span></div><div class="pricing-usd">‚âà 40 USD</div><div class="pricing-desc">Accompagnement complet</div></div>
                            <ul class="pricing-features"><li class="included">27 questions / 9 cat√©gories</li><li class="included">Score global + scores DIC</li><li class="included highlight"><strong>Rapport PDF d√©taill√©</strong></li><li class="included highlight"><strong>Analyse DIC approfondie</strong></li><li class="included highlight"><strong>Plan d'action 90 jours</strong></li><li class="included highlight"><strong>Expert sous 48h</strong></li></ul>
                            <button class="pricing-cta pro" onclick="selectPlan('pro')">Choisir Pro</button>
                        </div>
                    </div>
                    <div class="payment-info"><h4>üí≥ Moyens de paiement (Pro)</h4><div class="payment-methods"><span class="payment-method">üü† Orange Money</span><span class="payment-method">üîµ Wave</span><span class="payment-method">üÖøÔ∏è PayPal</span><span class="payment-method">üí≥ Carte</span></div><p style="font-size:.85rem;color:var(--gray-500)">Sous 48h apr√®s paiement, recevez votre rapport d√©taill√©.</p></div>
                    <div class="nav-buttons" style="justify-content:center;margin-top:2rem"><button class="btn btn-secondary" onclick="showSection('home')">‚Üê Retour</button></div>
                </div>
            </div>
        </section>

        <section id="lead-form" class="section">
            <div class="container">
                <div class="form-section">
                    <div class="version-indicator"><span class="version-badge" id="versionBadge">Version Gratuite</span></div>
                    <div class="form-header"><h2>üìù Vos informations</h2><p>Pour personnaliser votre rapport</p></div>
                    <div class="form-card">
                        <form id="leadForm">
                            <div class="form-group"><label>Nom de l'entreprise <span class="required">*</span></label><input type="text" id="companyName" required placeholder="Ex: SARL Exemple"></div>
                            <div class="form-group"><label>Votre nom complet <span class="required">*</span></label><input type="text" id="contactName" required placeholder="Ex: Jean Dupont"></div>
                            <div class="form-group"><label>Email professionnel <span class="required">*</span></label><input type="email" id="contactEmail" required placeholder="Ex: jean@entreprise.com"></div>
                            <div class="form-group"><label>T√©l√©phone</label><input type="tel" id="contactPhone" placeholder="+226 XX XX XX XX"></div>
                            <div class="form-group"><label>Secteur d'activit√© <span class="required">*</span></label><select id="sector" required><option value="">S√©lectionnez</option><option>Commerce / Distribution</option><option>Services aux entreprises</option><option>Industrie / Production</option><option>Banque / Finance / Assurance</option><option>Sant√©</option><option>√âducation / Formation</option><option>ONG / Association</option><option>Secteur public</option><option>Technologies / IT</option><option>BTP / Construction</option><option>Transport / Logistique</option><option>H√¥tellerie / Restauration</option><option>Autre</option></select></div>
                            <div class="form-group"><label>Nombre d'employ√©s <span class="required">*</span></label><select id="employees" required><option value="">S√©lectionnez</option><option>1-10</option><option>11-50</option><option>51-200</option><option>200+</option></select></div>
                            <div class="nav-buttons"><button type="button" class="btn btn-secondary" onclick="showSection('pricing')">‚Üê Retour</button><button type="submit" class="btn btn-primary">Commencer ‚Üí</button></div>
                        </form>
                        <p class="form-privacy">üîí Donn√©es confidentielles et s√©curis√©es</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="quiz" class="section">
            <div class="container">
                <div class="quiz-header"><h2>Diagnostic en cours</h2><div class="progress-container"><div class="progress-bar" id="progressBar"></div></div><p class="progress-text"><span id="currentQuestion">1</span> sur <span id="totalQuestions">24</span></p></div>
                <div style="text-align:center"><div class="category-indicator"><span id="categoryIcon">üñ•Ô∏è</span> <span id="categoryName">Infrastructure IT</span></div></div>
                <div class="question-card">
                    <div class="question-dic" id="questionDic">Crit√®re : Disponibilit√©</div>
                    <p class="question-text" id="questionText">Chargement...</p>
                    <div class="options" id="optionsContainer"></div>
                </div>
                <div class="nav-buttons"><button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()" disabled>‚Üê Pr√©c√©dent</button><button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>Suivant ‚Üí</button></div>
            </div>
        </section>

        <section id="results" class="section">
            <div class="container">
                <div class="results-header"><h2>üéâ Diagnostic termin√© !</h2><p id="resultsCompanyName"></p></div>
                <div class="score-display">
                    <div class="score-circle" id="scoreCircle" style="--score:0"><div class="score-value"><span id="scoreValue">0</span><span>/100</span></div></div>
                    <p class="score-label" id="scoreLabel">Niveau</p>
                    <p class="score-description" id="scoreDescription"></p>
                    <div class="dic-scores">
                        <div class="dic-score-item"><div class="label">üü¢ Disponibilit√©</div><div class="value" id="dicDisp">0%</div></div>
                        <div class="dic-score-item"><div class="label">üîµ Int√©grit√©</div><div class="value" id="dicInt">0%</div></div>
                        <div class="dic-score-item"><div class="label">üü£ Confidentialit√©</div><div class="value" id="dicConf">0%</div></div>
                    </div>
                </div>
                <div class="download-section"><button class="btn btn-accent" onclick="downloadPDF()">üìÑ T√©l√©charger PDF</button><button class="btn btn-secondary" onclick="restartQuiz()">üîÑ Refaire</button></div>
                <div id="proPaySection" style="display:none;background:linear-gradient(135deg,#FFD700,#FFA500);padding:1.5rem;border-radius:16px;margin-bottom:2rem;text-align:center"><h3 style="font-family:'Space Grotesk',sans-serif;margin-bottom:.5rem">‚≠ê Finalisez votre commande Pro</h3><p style="font-size:.85rem;margin-bottom:1rem">Pour recevoir votre rapport d√©taill√© sous 48h :</p><a href="mailto:comptabilite.bf@progressthings.com?subject=[DigiPME Pro] Paiement" class="btn" style="background:#1a1a1a;color:#fff">üí≥ Payer 25 000 XOF</a><p style="font-size:.8rem;margin-top:.75rem">üìß comptabilite.bf@progressthings.com</p></div>
                <div class="pro-upsell" id="proUpsell"><h3>‚≠ê Passez √† Pro</h3><div class="price">25 000 <span>XOF ‚âà 40 USD</span></div><ul class="benefits"><li>Expert sous 48h</li><li>Rapport PDF d√©taill√© + analyse DIC</li><li>Plan d'action 90 jours</li></ul><div class="payment-methods-pro"><span>üü† Orange Money</span><span>üîµ Wave</span><span>üÖøÔ∏è PayPal</span></div><a href="https://www.progressthings.com" target="_blank" class="btn" style="background:linear-gradient(135deg,#FFD700,#FFA500);color:#1a1a1a;margin-top:1rem">Contacter ‚Üí</a></div>
                <div class="chart-container"><h3>üìä Analyse par cat√©gorie</h3><canvas id="radarChart"></canvas></div>
                <div class="category-scores" id="categoryScores"></div>
                <div class="solutions-section"><h3>üõ†Ô∏è Solutions Progress Things</h3><p>Adapt√©es √† votre diagnostic :</p><div id="solutionsList"></div></div>
                <div class="recommendations"><h3>üìã Recommandations prioritaires</h3><div id="recommendationsList"></div></div>
                <div class="results-cta"><h3>Besoin d'accompagnement ?</h3><p>Nos experts sont pr√™ts √† vous aider.</p><a href="https://www.progressthings.com" target="_blank" class="btn btn-dark">Visiter Progress Things ‚Üí</a><div class="contact-info">üåê www.progressthings.com ‚Ä¢ üìç Ouagadougou</div></div>
            </div>
        </section>
    </main>

    <div class="toast" id="toast"><span id="toastMessage"></span></div>

    <footer>
        <p style="font-size:1.1rem;font-weight:600">Digi<span style="color:#00D4AA">PME</span></p>
        <p>by <a href="https://www.progressthings.com" target="_blank">Progress Things</a></p>
        <p>¬© 2024 ‚Äî Diagnostic de maturit√© num√©rique TPE/PME</p>
        <p class="footer-tagline">Let's do it together</p>
    </footer>

<script>
const EMAILJS_PUBLIC_KEY = "LF6930gGEBQZK63sJ";
const EMAILJS_SERVICE_ID = "service_y7puafd";
const EMAILJS_TEMPLATE_ID = "template_o67tdos";

document.getElementById('consentCheck').addEventListener('change', function() {
    document.getElementById('consentBtn').disabled = !this.checked;
});
function acceptConsent() {
    document.getElementById('consentOverlay').classList.add('hidden');
    localStorage.setItem('digipme_consent', 'true');
}
if (localStorage.getItem('digipme_consent') === 'true') {
    document.getElementById('consentOverlay').classList.add('hidden');
}

const categories = [
    { id:'infrastructure', name:'Infrastructure IT', icon:'üñ•Ô∏è', pdfName:'Infrastructure IT', questions:[
        { text:"Quel est l'√©tat de vos √©quipements informatiques (PC, serveurs) ?", dic:"Disponibilit√©", options:[{text:"Tr√®s anciens (+7 ans), pannes fr√©quentes",score:0},{text:"Anciens (5-7 ans), quelques probl√®mes",score:1},{text:"Corrects (3-5 ans), fonctionnent bien",score:2},{text:"R√©cents (-3 ans), performants",score:3}]},
        { text:"Comment est organis√© votre r√©seau informatique ?", dic:"Disponibilit√©", options:[{text:"Pas de r√©seau structur√©",score:0},{text:"R√©seau basique sans documentation",score:1},{text:"R√©seau structur√© avec switch/routeur",score:2},{text:"R√©seau segment√©, document√©, monitoring",score:3}]},
        { text:"Avez-vous un contrat de maintenance informatique ?", dic:"Disponibilit√©", options:[{text:"Non, on r√©pare quand √ßa casse",score:0},{text:"Technicien appel√© au besoin",score:1},{text:"Contrat maintenance curative",score:2},{text:"Contrat pr√©ventif avec SLA",score:3}]}
    ]},
    { id:'cybersecurity', name:'Cybers√©curit√©', icon:'üîí', pdfName:'Cybersecurite', questions:[
        { text:"Quelle protection utilisez-vous sur vos postes ?", dic:"Int√©grit√©", options:[{text:"Aucune ou antivirus gratuit expir√©",score:0},{text:"Antivirus gratuit basique",score:1},{text:"Antivirus payant sur tous les postes",score:2},{text:"Solution EDR/XDR pro (ex: ESET)",score:3}]},
        { text:"Comment g√©rez-vous les sauvegardes ?", dic:"Int√©grit√©", options:[{text:"Pas de sauvegarde r√©guli√®re",score:0},{text:"Sauvegarde manuelle (cl√© USB)",score:1},{text:"Sauvegarde automatique locale",score:2},{text:"Sauvegarde 3-2-1 (local + cloud + test)",score:3}]},
        { text:"Vos employ√©s sont-ils sensibilis√©s au phishing ?", dic:"Confidentialit√©", options:[{text:"Jamais sensibilis√©s",score:0},{text:"Consignes informelles",score:1},{text:"Formation ponctuelle r√©alis√©e",score:2},{text:"Programme r√©gulier + tests phishing",score:3}]}
    ]},
    { id:'physical_security', name:'S√©curit√© Physique', icon:'üìπ', pdfName:'Securite Physique', questions:[
        { text:"Avez-vous un syst√®me de vid√©osurveillance ?", dic:"Confidentialit√©", options:[{text:"Non, aucune cam√©ra",score:0},{text:"Cam√©ras non fonctionnelles",score:1},{text:"Cam√©ras avec enregistrement local",score:2},{text:"Vid√©osurveillance IP + stockage s√©curis√©",score:3}]},
        { text:"Comment contr√¥lez-vous l'acc√®s √† vos locaux ?", dic:"Confidentialit√©", options:[{text:"Portes ouvertes, pas de contr√¥le",score:0},{text:"Cl√©s physiques simples",score:1},{text:"Badges ou codes d'acc√®s",score:2},{text:"Badges avec tra√ßabilit√©/biom√©trie",score:3}]},
        { text:"Disposez-vous d'un syst√®me d'alarme ?", dic:"Disponibilit√©", options:[{text:"Non, aucune alarme",score:0},{text:"Alarme basique non connect√©e",score:1},{text:"Alarme connect√©e avec notification",score:2},{text:"Alarme + t√©l√©surveillance 24/7",score:3}]}
    ]},
    { id:'continuity', name:'Continuit√© d\'activit√©', icon:'‚ö°', pdfName:'Continuite activite', questions:[
        { text:"Comment √™tes-vous prot√©g√©s contre les coupures √©lectriques ?", dic:"Disponibilit√©", options:[{text:"Aucune protection",score:0},{text:"Quelques onduleurs",score:1},{text:"Onduleurs sur √©quipements critiques",score:2},{text:"Onduleur central + groupe √©lectrog√®ne",score:3}]},
        { text:"Quelle autonomie en cas de coupure ?", dic:"Disponibilit√©", options:[{text:"Aucune (arr√™t imm√©diat)",score:0},{text:"Moins de 10 minutes",score:1},{text:"10-30 minutes",score:2},{text:"+30 min ou PC portables",score:3}]},
        { text:"Avez-vous un plan de continuit√© (PCA) ?", dic:"Disponibilit√©", options:[{text:"Non, aucun plan",score:0},{text:"R√©flexions informelles",score:1},{text:"Proc√©dures basiques document√©es",score:2},{text:"PCA complet test√© r√©guli√®rement",score:3}]}
    ]},
    { id:'data_recovery', name:'Donn√©es & Reprise', icon:'üíæ', pdfName:'Donnees et Reprise', questions:[
        { text:"Comment sont stock√©es vos donn√©es critiques (comptabilit√©, clients, stocks) ?", dic:"Int√©grit√©", options:[{text:"Fichiers Excel/Word dispers√©s sur les PC",score:0},{text:"Dossiers partag√©s sans organisation",score:1},{text:"Serveur de fichiers ou NAS centralis√©",score:2},{text:"Base de donn√©es/ERP centralis√© avec acc√®s contr√¥l√©",score:3}]},
        { text:"Avez-vous un plan de reprise d'activit√© (PRA) en cas de sinistre ?", dic:"Disponibilit√©", options:[{text:"Non, jamais r√©fl√©chi",score:0},{text:"Id√©e g√©n√©rale mais rien de document√©",score:1},{text:"Proc√©dures √©crites mais non test√©es",score:2},{text:"PRA document√© et test√© r√©guli√®rement",score:3}]},
        { text:"En cas de panne majeure, en combien de temps pouvez-vous reprendre l'activit√© ?", dic:"Disponibilit√©", options:[{text:"Plusieurs jours/semaines, incertain",score:0},{text:"1-2 jours avec pertes de donn√©es",score:1},{text:"Quelques heures avec donn√©es r√©centes",score:2},{text:"Moins d'1h, RTO/RPO d√©finis et test√©s",score:3}]}
    ]},
    { id:'collaboration', name:'Outils collaboratifs', icon:'üë•', pdfName:'Outils collaboratifs', questions:[
        { text:"Quelle messagerie professionnelle utilisez-vous ?", dic:"Confidentialit√©", options:[{text:"Gmail/Yahoo personnel",score:0},{text:"Email @gmail pour le travail",score:1},{text:"Email professionnel basique",score:2},{text:"Microsoft 365 / Google Workspace",score:3}]},
        { text:"Comment partagez-vous les fichiers ?", dic:"Int√©grit√©", options:[{text:"Cl√©s USB, pi√®ces jointes",score:0},{text:"WhatsApp, WeTransfer",score:1},{text:"Serveur local ou Drive basique",score:2},{text:"OneDrive/SharePoint avec droits",score:3}]},
        { text:"Utilisez-vous des outils de communication d'√©quipe ?", dic:"Disponibilit√©", options:[{text:"T√©l√©phone/SMS uniquement",score:0},{text:"WhatsApp pour le travail",score:1},{text:"Zoom/Meet occasionnel",score:2},{text:"Teams/Slack au quotidien",score:3}]}
    ]},
    { id:'digital_presence', name:'Pr√©sence digitale', icon:'üåê', pdfName:'Presence digitale', questions:[
        { text:"Avez-vous un site web professionnel ?", dic:"Disponibilit√©", options:[{text:"Non, aucun site",score:0},{text:"Page Facebook uniquement",score:1},{text:"Site vitrine basique",score:2},{text:"Site pro, responsive, mis √† jour",score:3}]},
        { text:"√ätes-vous actifs sur les r√©seaux sociaux ?", dic:"Disponibilit√©", options:[{text:"Aucune pr√©sence",score:0},{text:"Comptes cr√©√©s mais inactifs",score:1},{text:"Pr√©sence active mais irr√©guli√®re",score:2},{text:"Strat√©gie social media r√©guli√®re",score:3}]},
        { text:"Comment les clients vous contactent en ligne ?", dic:"Disponibilit√©", options:[{text:"T√©l√©phone uniquement",score:0},{text:"Email visible",score:1},{text:"Formulaire de contact",score:2},{text:"Multi-canaux (chat, WhatsApp, etc.)",score:3}]}
    ]},
    { id:'skills', name:'Comp√©tences √©quipe', icon:'üéì', pdfName:'Competences equipe', questions:[
        { text:"Quel est le niveau IT de vos employ√©s ?", dic:"Int√©grit√©", options:[{text:"Tr√®s basique, difficult√©s",score:0},{text:"Basique, t√¢ches simples OK",score:1},{text:"Correct, autonomes",score:2},{text:"Bon niveau, √† l'aise",score:3}]},
        { text:"Proposez-vous des formations IT ?", dic:"Int√©grit√©", options:[{text:"Jamais",score:0},{text:"Tr√®s rarement",score:1},{text:"Occasionnellement",score:2},{text:"Plan de formation r√©gulier",score:3}]},
        { text:"Avez-vous un support IT disponible ?", dic:"Disponibilit√©", options:[{text:"Non, chacun se d√©brouille",score:0},{text:"Coll√®gue 'qui s'y conna√Æt'",score:1},{text:"Prestataire externe au besoin",score:2},{text:"Support d√©di√© avec tickets",score:3}]}
    ]},
    { id:'identity', name:'Gestion des identit√©s', icon:'üîë', pdfName:'Gestion identites', questions:[
        { text:"Comment g√©rez-vous les comptes utilisateurs ?", dic:"Confidentialit√©", options:[{text:"Comptes partag√©s, pas de proc√©dure",score:0},{text:"Comptes individuels sans proc√©dure",score:1},{text:"Proc√©dure cr√©ation/suppression",score:2},{text:"Annuaire centralis√© (AD/Entra)",score:3}]},
        { text:"Comment g√©rez-vous les droits d'acc√®s ?", dic:"Confidentialit√©", options:[{text:"Tout le monde acc√®de √† tout",score:0},{text:"Quelques restrictions informelles",score:1},{text:"Droits par service/r√¥le",score:2},{text:"Moindre privil√®ge + revue r√©guli√®re",score:3}]},
        { text:"Utilisez-vous le MFA (double authentification) ?", dic:"Confidentialit√©", options:[{text:"Non, je ne connais pas",score:0},{text:"Non, mais je connais",score:1},{text:"Sur certains comptes",score:2},{text:"Obligatoire partout",score:3}]}
    ]}
];

const ptSolutions = {
    infrastructure:{name:"Support IT Manag√©",pdfName:"Support IT Manage",desc:"Maintenance pr√©ventive, supervision, gestion parc.",tag:"Infra",icon:"üñ•Ô∏è"},
    cybersecurity:{name:"Cybers√©curit√© ESET",pdfName:"Cybersecurite ESET",desc:"EDR, sauvegarde cloud, sensibilisation.",tag:"S√©curit√©",icon:"üîí"},
    physical_security:{name:"Vid√©osurveillance",pdfName:"Videosurveillance",desc:"Cam√©ras IP, contr√¥le d'acc√®s, alarmes.",tag:"Protection",icon:"üìπ"},
    continuity:{name:"Continuit√© d'activit√©",pdfName:"Continuite",desc:"Onduleurs, groupe √©lectrog√®ne, PCA.",tag:"R√©silience",icon:"‚ö°"},
    data_recovery:{name:"Backup & Reprise",pdfName:"Backup et Reprise",desc:"Sauvegarde 3-2-1, PRA, RTO/RPO, restauration.",tag:"Recovery",icon:"üíæ"},
    collaboration:{name:"Microsoft 365",pdfName:"Microsoft 365",desc:"Outlook, Teams, OneDrive, SharePoint.",tag:"Productivit√©",icon:"üë•"},
    digital_presence:{name:"Conseil Digital",pdfName:"Conseil Digital",desc:"Site web, r√©seaux sociaux.",tag:"Visibilit√©",icon:"üåê"},
    skills:{name:"Formations IT",pdfName:"Formations IT",desc:"M365, cybers√©curit√©, outils.",tag:"Formation",icon:"üéì"},
    identity:{name:"Gestion identit√©s",pdfName:"Gestion identites",desc:"Entra ID, SSO, MFA.",tag:"IAM",icon:"üîë"}
};

const levelDescriptions = {
    beginner:{label:"üî¥ D√©butant",pdfLabel:"Debutant",desc:"Fort potentiel. Des actions simples feront une grande diff√©rence."},
    developing:{label:"üü† En d√©veloppement",pdfLabel:"En developpement",desc:"Bases pos√©es. Structurez et s√©curisez."},
    intermediate:{label:"üü° Interm√©diaire",pdfLabel:"Intermediaire",desc:"Bonne maturit√© ! Quelques optimisations √† faire."},
    advanced:{label:"üü¢ Avanc√©",pdfLabel:"Avance",desc:"IT bien structur√©e. Focus optimisation."},
    expert:{label:"üèÜ Expert",pdfLabel:"Expert",desc:"Excellente maturit√© ! Continuez ainsi."}
};

let currentQuestionIndex = 0, answers = [], leadData = {}, selectedPlan = 'free';
const totalQuestions = categories.reduce((s,c) => s + c.questions.length, 0);

function showToast(m, t='info') { const e=document.getElementById('toast'); document.getElementById('toastMessage').textContent=m; e.className='toast show '+t; setTimeout(()=>e.classList.remove('show'),3000); }
function showSection(id) { document.querySelectorAll('.section').forEach(s=>s.classList.remove('active')); document.getElementById(id).classList.add('active'); window.scrollTo(0,0); }
function selectPlan(p) { selectedPlan=p; const b=document.getElementById('versionBadge'); b.className=p==='pro'?'version-badge pro':'version-badge free'; b.innerHTML=p==='pro'?'‚≠ê Version Pro ‚Äî 25 000 XOF':'Version Gratuite'; showSection('lead-form'); }

document.getElementById('leadForm').addEventListener('submit', function(e) {
    e.preventDefault();
    leadData = { companyName:document.getElementById('companyName').value, contactName:document.getElementById('contactName').value, contactEmail:document.getElementById('contactEmail').value, contactPhone:document.getElementById('contactPhone').value||'Non renseign√©', sector:document.getElementById('sector').value, employees:document.getElementById('employees').value, date:new Date().toLocaleDateString('fr-FR'), plan:selectedPlan };
    currentQuestionIndex=0; answers=new Array(totalQuestions).fill(null);
    document.getElementById('totalQuestions').textContent=totalQuestions;
    showSection('quiz'); displayQuestion();
});

function getQuestionData(idx) { let c=0; for(let cat of categories){for(let q of cat.questions){if(c===idx)return{category:cat,question:q};c++;}} return null; }

function displayQuestion() {
    const d=getQuestionData(currentQuestionIndex); if(!d)return;
    document.getElementById('categoryIcon').textContent=d.category.icon;
    document.getElementById('categoryName').textContent=d.category.name;
    document.getElementById('questionText').textContent=d.question.text;
    document.getElementById('questionDic').textContent='Crit√®re √©valu√© : '+d.question.dic;
    const cont=document.getElementById('optionsContainer'); cont.innerHTML='';
    d.question.options.forEach((o,i)=>{ const div=document.createElement('div'); div.className='option'+(answers[currentQuestionIndex]===i?' selected':''); div.onclick=()=>selectOption(i); div.innerHTML='<div class="option-radio"></div><span class="option-text">'+o.text+'</span>'; cont.appendChild(div); });
    document.getElementById('progressBar').style.width=((currentQuestionIndex+1)/totalQuestions*100)+'%';
    document.getElementById('currentQuestion').textContent=currentQuestionIndex+1;
    document.getElementById('prevBtn').disabled=currentQuestionIndex===0;
    updateNextButton();
}

function selectOption(i) { answers[currentQuestionIndex]=i; document.querySelectorAll('.option').forEach((o,idx)=>o.classList.toggle('selected',idx===i)); updateNextButton(); }
function updateNextButton() { const b=document.getElementById('nextBtn'); b.disabled=answers[currentQuestionIndex]===null; b.textContent=currentQuestionIndex===totalQuestions-1?'Voir r√©sultats ‚Üí':'Suivant ‚Üí'; }
function nextQuestion() { if(answers[currentQuestionIndex]===null)return; if(currentQuestionIndex<totalQuestions-1){currentQuestionIndex++;displayQuestion();}else{calculateResults();} }
function previousQuestion() { if(currentQuestionIndex>0){currentQuestionIndex--;displayQuestion();} }
function restartQuiz() { showSection('home'); }

function calculateResults() {
    const catScores={}, dicScores={'Disponibilit√©':[],'Int√©grit√©':[],'Confidentialit√©':[]}; let qIdx=0;
    categories.forEach(cat=>{ let s=0,m=cat.questions.length*3; cat.questions.forEach(q=>{ if(answers[qIdx]!==null){const sc=q.options[answers[qIdx]].score;s+=sc;dicScores[q.dic].push(sc/3*100);} qIdx++; }); catScores[cat.id]={name:cat.name,pdfName:cat.pdfName,icon:cat.icon,score:Math.round(s/m*100)}; });
    const total=Math.round(Object.values(catScores).reduce((s,c)=>s+c.score,0)/categories.length);
    const dicFinal={ disponibilite:Math.round(dicScores['Disponibilit√©'].reduce((a,b)=>a+b,0)/dicScores['Disponibilit√©'].length), integrite:Math.round(dicScores['Int√©grit√©'].reduce((a,b)=>a+b,0)/dicScores['Int√©grit√©'].length), confidentialite:Math.round(dicScores['Confidentialit√©'].reduce((a,b)=>a+b,0)/dicScores['Confidentialit√©'].length) };
    displayResults(total,catScores,dicFinal); sendEmail(total,catScores,dicFinal);
}

function getLevel(s) { if(s<30)return'beginner';if(s<50)return'developing';if(s<70)return'intermediate';if(s<90)return'advanced';return'expert'; }
function getInterp(id,s) { const i={infrastructure:{l:"Modernisation urgente.",m:"Correcte, ameliorations possibles.",h:"Bonne infrastructure."},cybersecurity:{l:"ALERTE: Tres vulnerable!",m:"Protection partielle.",h:"Bonne securite."},physical_security:{l:"Securite physique insuffisante.",m:"Protection partielle.",h:"Bonne securite."},continuity:{l:"Aucune resilience.",m:"Continuite partielle.",h:"Bonne continuite."},data_recovery:{l:"CRITIQUE: Risque perte donnees!",m:"Backup partiel, PRA a formaliser.",h:"Bonne strategie de reprise."},collaboration:{l:"Outils inadaptes.",m:"Sous-utilises.",h:"Bonne collaboration."},digital_presence:{l:"Invisible en ligne.",m:"Presence basique.",h:"Bonne visibilite."},skills:{l:"Competences insuffisantes.",m:"Niveau correct.",h:"Equipe competente."},identity:{l:"Gestion chaotique.",m:"Gestion partielle.",h:"Bonne gestion."}}; return i[id]?.[s<40?'l':s<70?'m':'h']||""; }

function sendEmail(score,catScores,dicFinal) {
    // G√©n√©rer le d√©tail des 24 r√©ponses
    let allAnswers = '';
    let qNum = 1;
    let qIdx = 0;
    categories.forEach(cat => {
        allAnswers += '\n--- ' + cat.pdfName.toUpperCase() + ' (' + catScores[cat.id].score + '%) ---\n';
        cat.questions.forEach(q => {
            const selectedOption = answers[qIdx];
            const selectedText = selectedOption !== null ? q.options[selectedOption].text : 'Non r√©pondu';
            const selectedScore = selectedOption !== null ? q.options[selectedOption].score : 0;
            allAnswers += 'Q' + qNum + '. ' + q.text + '\n';
            allAnswers += '   > Reponse: ' + selectedText + ' (Score: ' + selectedScore + '/3)\n';
            qNum++;
            qIdx++;
        });
    });
    
    // G√©n√©rer les suggestions/recommandations
    let suggestions = '\n=== RECOMMANDATIONS PRIORITAIRES ===\n';
    Object.entries(catScores)
        .filter(([id, c]) => c.score < 70)
        .sort((a, b) => a[1].score - b[1].score)
        .forEach(([id, c]) => {
            const sol = ptSolutions[id];
            const priority = c.score < 40 ? 'URGENT' : 'A AMELIORER';
            suggestions += '\n[' + priority + '] ' + c.pdfName + ' (' + c.score + '%)\n';
            suggestions += '   Analyse: ' + getInterp(id, c.score) + '\n';
            if (sol) {
                suggestions += '   Solution PT: ' + sol.pdfName + ' - ' + sol.desc + '\n';
            }
        });
    
    if (Object.values(catScores).every(c => c.score >= 70)) {
        suggestions += '\nExcellente maturite sur tous les aspects. Continuer les bonnes pratiques.\n';
    }
    
    // Scores par cat√©gorie
    const catDetails = Object.entries(catScores).map(([id,c]) => c.pdfName + ': ' + c.score + '%').join(' | ');
    
    const data = {
        company_name: leadData.companyName,
        contact_name: leadData.contactName,
        contact_email: leadData.contactEmail,
        contact_phone: leadData.contactPhone,
        sector: leadData.sector,
        employees: leadData.employees,
        plan: leadData.plan === 'pro' ? 'PRO (25 000 XOF)' : 'GRATUIT',
        date: leadData.date,
        score: score,
        level: levelDescriptions[getLevel(score)].pdfLabel,
        dic_disponibilite: dicFinal.disponibilite + '%',
        dic_integrite: dicFinal.integrite + '%',
        dic_confidentialite: dicFinal.confidentialite + '%',
        category_scores: catDetails,
        all_answers: allAnswers,
        suggestions: suggestions,
        subject: '[DigiPME] ' + leadData.companyName + ' - Score: ' + score + '/100 - ' + leadData.plan.toUpperCase()
    };
    
    if (EMAILJS_PUBLIC_KEY) {
        emailjs.init(EMAILJS_PUBLIC_KEY);
        emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, data)
            .then(() => console.log('Email envoy√© avec succ√®s!'))
            .catch(e => console.error('Erreur email:', e));
    }
    
    // Afficher aussi dans la console pour debug
    console.log('===== DIAGNOSTIC COMPLET =====');
    console.log('Entreprise:', leadData.companyName);
    console.log('Contact:', leadData.contactName, '-', leadData.contactEmail, '-', leadData.contactPhone);
    console.log('Secteur:', leadData.sector, '| Employ√©s:', leadData.employees);
    console.log('Plan:', leadData.plan);
    console.log('Score:', score + '/100 -', levelDescriptions[getLevel(score)].pdfLabel);
    console.log('DIC:', 'Dispo:', dicFinal.disponibilite + '%', '| Int√©g:', dicFinal.integrite + '%', '| Confid:', dicFinal.confidentialite + '%');
    console.log(allAnswers);
    console.log(suggestions);
    console.log('==============================');
}

function displayResults(total,catScores,dicFinal) {
    showSection('results');
    document.getElementById('resultsCompanyName').textContent=leadData.companyName;
    document.getElementById('proUpsell').style.display=selectedPlan==='free'?'block':'none';
    document.getElementById('proPaySection').style.display=selectedPlan==='pro'?'block':'none';
    document.getElementById('dicDisp').textContent=dicFinal.disponibilite+'%';
    document.getElementById('dicInt').textContent=dicFinal.integrite+'%';
    document.getElementById('dicConf').textContent=dicFinal.confidentialite+'%';
    const circle=document.getElementById('scoreCircle'),val=document.getElementById('scoreValue'); let cur=0;
    const anim=setInterval(()=>{if(cur>=total)clearInterval(anim);else{cur++;val.textContent=cur;circle.style.setProperty('--score',cur);}},20);
    const level=getLevel(total),levelInfo=levelDescriptions[level];
    document.getElementById('scoreLabel').textContent=levelInfo.label;
    document.getElementById('scoreDescription').textContent=levelInfo.desc;
    const scCont=document.getElementById('categoryScores'); scCont.innerHTML='';
    Object.entries(catScores).forEach(([id,c])=>{ const lv=c.score<40?'low':c.score<70?'medium':'high'; scCont.innerHTML+='<div class="category-score-card"><div class="category-score-header"><span class="category-score-name">'+c.icon+' '+c.name+'</span><span class="category-score-value '+lv+'">'+c.score+'%</span></div><div class="category-score-bar"><div class="category-score-fill '+lv+'" style="width:'+c.score+'%"></div></div><p class="category-score-desc">'+getInterp(id,c.score)+'</p></div>'; });
    createRadarChart(catScores); generateSolutions(catScores); generateRecs(catScores);
    window.resultsData={totalScore:total,categoryScores:catScores,dicFinal,level,levelInfo};
    showToast('Diagnostic termin√© !','success');
}

function createRadarChart(catScores) {
    const ctx=document.getElementById('radarChart').getContext('2d');
    if(window.radarChartInstance)window.radarChartInstance.destroy();
    window.radarChartInstance=new Chart(ctx,{type:'radar',data:{labels:Object.values(catScores).map(c=>c.pdfName),datasets:[{label:'Score',data:Object.values(catScores).map(c=>c.score),backgroundColor:'rgba(0,212,170,0.2)',borderColor:'#00D4AA',borderWidth:2,pointBackgroundColor:'#00D4AA'}]},options:{responsive:true,scales:{r:{beginAtZero:true,max:100,ticks:{stepSize:20}}},plugins:{legend:{display:false}}}});
}

function generateSolutions(catScores) {
    const cont=document.getElementById('solutionsList'); cont.innerHTML='';
    Object.entries(catScores).sort((a,b)=>a[1].score-b[1].score).filter(([id,c])=>c.score<70).slice(0,4).forEach(([id])=>{ const sol=ptSolutions[id]; if(sol)cont.innerHTML+='<div class="solution-card"><div class="solution-header"><div class="solution-icon">'+sol.icon+'</div><div class="solution-title">'+sol.name+'</div></div><div class="solution-description">'+sol.desc+'</div><span class="solution-tag">'+sol.tag+'</span></div>'; });
    if(!cont.innerHTML)cont.innerHTML='<div class="solution-card"><div class="solution-header"><div class="solution-icon">üèÜ</div><div class="solution-title">F√©licitations !</div></div><div class="solution-description">Excellente maturit√©.</div></div>';
}

function generateRecs(catScores) {
    const cont=document.getElementById('recommendationsList'); cont.innerHTML='';
    Object.entries(catScores).filter(([id,c])=>c.score<70).sort((a,b)=>a[1].score-b[1].score).slice(0,5).forEach(([id,c])=>{ const p=c.score<40?'high':'medium',sol=ptSolutions[id]; cont.innerHTML+='<div class="recommendation-item"><div class="recommendation-icon priority-'+p+'">'+c.icon+'</div><div class="recommendation-content"><h4>'+(c.score<40?'‚ö†Ô∏è ':'')+'Am√©liorer '+c.name+'</h4><p>'+getInterp(id,c.score)+'</p>'+(sol?'<div class="pt-solution">‚Üí '+sol.name+'</div>':'')+'</div></div>'; });
    if(!cont.innerHTML)cont.innerHTML='<div class="recommendation-item"><div class="recommendation-icon" style="background:rgba(16,185,129,.1)">üèÜ</div><div class="recommendation-content"><h4>Excellente maturit√© !</h4><p>Continuez vos bonnes pratiques.</p></div></div>';
}

function downloadPDF() {
    const d = window.resultsData;
    if (!d) { showToast('Erreur', 'error'); return; }
    
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const pw = doc.internal.pageSize.getWidth();
    const ph = doc.internal.pageSize.getHeight();
    let y = 15;
    let pageNum = 1;
    
    const footer = () => {
        doc.setFillColor(26, 26, 26);
        doc.rect(0, ph - 12, pw, 12, 'F');
        doc.setTextColor(255, 255, 255);
        doc.setFontSize(7);
        doc.text('DigiPME by Progress Things - www.progressthings.com - Page ' + pageNum, pw / 2, ph - 5, { align: 'center' });
    };
    
    const header = (title) => {
        doc.setFillColor(26, 26, 26);
        doc.rect(0, 0, pw, 15, 'F');
        doc.setTextColor(0, 212, 170);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'bold');
        doc.text('DigiPME', 15, 10);
        doc.setTextColor(150, 150, 150);
        doc.setFontSize(8);
        doc.text(' - ' + leadData.companyName + ' - ' + title, 38, 10);
    };
    
    const newPage = (title) => {
        footer();
        doc.addPage();
        pageNum++;
        header(title);
        return 22;
    };
    
    const checkPage = (needed, title) => {
        if (y + needed > ph - 20) {
            y = newPage(title);
        }
    };
    
    // ========== PAGE 1: R√âSUM√â ==========
    doc.setFillColor(26, 26, 26);
    doc.rect(0, 0, pw, 28, 'F');
    doc.setTextColor(0, 212, 170);
    doc.setFontSize(20);
    doc.setFont('helvetica', 'bold');
    doc.text('DigiPME', 15, 17);
    doc.setTextColor(150, 150, 150);
    doc.setFontSize(9);
    doc.text('by Progress Things', 50, 17);
    doc.text('Rapport du ' + leadData.date, pw - 15, 17, { align: 'right' });
    
    y = 38;
    doc.setTextColor(26, 26, 26);
    doc.setFontSize(16);
    doc.setFont('helvetica', 'bold');
    doc.text('RAPPORT DE MATURITE NUMERIQUE', pw / 2, y, { align: 'center' });
    
    y += 8;
    doc.setTextColor(0, 212, 170);
    doc.setFontSize(14);
    doc.text(leadData.companyName, pw / 2, y, { align: 'center' });
    
    y += 6;
    doc.setTextColor(100, 100, 100);
    doc.setFontSize(9);
    doc.setFont('helvetica', 'normal');
    doc.text('Secteur: ' + leadData.sector + ' | ' + leadData.employees + ' employes', pw / 2, y, { align: 'center' });
    
    y += 5;
    doc.text('Contact: ' + leadData.contactName + ' | ' + leadData.contactEmail + ' | ' + leadData.contactPhone, pw / 2, y, { align: 'center' });
    
    y += 12;
    
    // Score box
    doc.setFillColor(26, 26, 26);
    doc.roundedRect(30, y, pw - 60, 35, 5, 5, 'F');
    doc.setTextColor(0, 212, 170);
    doc.setFontSize(32);
    doc.setFont('helvetica', 'bold');
    doc.text(d.totalScore + '/100', pw / 2, y + 18, { align: 'center' });
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(11);
    doc.text('Niveau: ' + d.levelInfo.pdfLabel, pw / 2, y + 28, { align: 'center' });
    
    y += 42;
    
    // DIC Scores
    doc.setFillColor(240, 240, 240);
    doc.roundedRect(15, y, pw - 30, 12, 3, 3, 'F');
    doc.setTextColor(26, 26, 26);
    doc.setFontSize(9);
    doc.setFont('helvetica', 'bold');
    doc.text('Scores DIC:', 20, y + 8);
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(16, 185, 129);
    doc.text('Disponibilite: ' + d.dicFinal.disponibilite + '%', 55, y + 8);
    doc.setTextColor(59, 130, 246);
    doc.text('Integrite: ' + d.dicFinal.integrite + '%', 100, y + 8);
    doc.setTextColor(139, 92, 246);
    doc.text('Confidentialite: ' + d.dicFinal.confidentialite + '%', 140, y + 8);
    
    y += 18;
    
    // Scores par cat√©gorie
    doc.setTextColor(26, 26, 26);
    doc.setFontSize(11);
    doc.setFont('helvetica', 'bold');
    doc.text('SCORES PAR CATEGORIE', 15, y);
    y += 7;
    
    Object.entries(d.categoryScores).forEach(([id, c]) => {
        const col = c.score < 40 ? [239, 68, 68] : c.score < 70 ? [245, 158, 11] : [16, 185, 129];
        doc.setFillColor(235, 235, 235);
        doc.roundedRect(15, y, pw - 30, 9, 2, 2, 'F');
        doc.setFillColor(...col);
        const bw = (pw - 30) * c.score / 100;
        if (bw > 3) doc.roundedRect(15, y, bw, 9, 2, 2, 'F');
        doc.setTextColor(40, 40, 40);
        doc.setFontSize(8);
        doc.setFont('helvetica', 'bold');
        doc.text(c.pdfName, 18, y + 6);
        doc.text(c.score + '%', pw - 18, y + 6, { align: 'right' });
        y += 11;
    });
    
    footer();
    
    // ========== PAGE 2+: D√âTAIL DES 24 R√âPONSES ==========
    y = newPage('Reponses detaillees');
    
    doc.setTextColor(26, 26, 26);
    doc.setFontSize(12);
    doc.setFont('helvetica', 'bold');
    doc.text('DETAIL DES REPONSES (24 questions)', 15, y);
    y += 8;
    
    let qNum = 1;
    let qIdx = 0;
    
    categories.forEach(cat => {
        // Titre de cat√©gorie
        checkPage(25, 'Reponses detaillees');
        
        const catScore = d.categoryScores[cat.id].score;
        const col = catScore < 40 ? [239, 68, 68] : catScore < 70 ? [245, 158, 11] : [16, 185, 129];
        
        doc.setFillColor(...col);
        doc.roundedRect(15, y, pw - 30, 8, 2, 2, 'F');
        doc.setTextColor(255, 255, 255);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'bold');
        doc.text(cat.pdfName.toUpperCase() + ' - Score: ' + catScore + '%', 20, y + 5.5);
        y += 12;
        
        // Questions de cette cat√©gorie
        cat.questions.forEach(q => {
            const selectedOption = answers[qIdx];
            const selectedText = selectedOption !== null ? q.options[selectedOption].text : 'Non repondu';
            const selectedScore = selectedOption !== null ? q.options[selectedOption].score : 0;
            
            checkPage(22, 'Reponses detaillees');
            
            // Question
            doc.setTextColor(26, 26, 26);
            doc.setFontSize(8);
            doc.setFont('helvetica', 'bold');
            const qText = 'Q' + qNum + '. ' + q.text;
            const qLines = doc.splitTextToSize(qText, pw - 35);
            doc.text(qLines, 15, y);
            y += qLines.length * 4 + 2;
            
            // R√©ponse
            const scoreCol = selectedScore === 0 ? [239, 68, 68] : selectedScore === 1 ? [245, 158, 11] : selectedScore === 2 ? [59, 130, 246] : [16, 185, 129];
            doc.setFillColor(245, 245, 245);
            doc.roundedRect(20, y, pw - 40, 10, 2, 2, 'F');
            doc.setFillColor(...scoreCol);
            doc.roundedRect(20, y, 3, 10, 1, 1, 'F');
            
            doc.setTextColor(60, 60, 60);
            doc.setFontSize(7);
            doc.setFont('helvetica', 'normal');
            const rLines = doc.splitTextToSize(selectedText, pw - 75);
            doc.text(rLines, 26, y + 4);
            
            // Score badge
            doc.setFillColor(...scoreCol);
            doc.roundedRect(pw - 35, y + 2, 18, 6, 2, 2, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(7);
            doc.setFont('helvetica', 'bold');
            doc.text(selectedScore + '/3', pw - 26, y + 6, { align: 'center' });
            
            y += 14;
            qNum++;
            qIdx++;
        });
        
        y += 3;
    });
    
    // ========== PAGE: RECOMMANDATIONS ==========
    y = newPage('Recommandations');
    
    doc.setTextColor(26, 26, 26);
    doc.setFontSize(12);
    doc.setFont('helvetica', 'bold');
    doc.text('RECOMMANDATIONS ET PLAN D\'ACTION', 15, y);
    y += 10;
    
    // Trier par score croissant (pires en premier)
    const sortedCats = Object.entries(d.categoryScores).sort((a, b) => a[1].score - b[1].score);
    
    sortedCats.forEach(([id, c]) => {
        checkPage(28, 'Recommandations');
        
        const col = c.score < 40 ? [239, 68, 68] : c.score < 70 ? [245, 158, 11] : [16, 185, 129];
        const priority = c.score < 40 ? 'URGENT' : c.score < 70 ? 'A AMELIORER' : 'BON';
        const interp = getInterp(id, c.score);
        const sol = ptSolutions[id];
        
        // Carte de recommandation
        doc.setFillColor(250, 250, 250);
        doc.roundedRect(15, y, pw - 30, sol && c.score < 70 ? 24 : 18, 3, 3, 'F');
        doc.setFillColor(...col);
        doc.roundedRect(15, y, 4, sol && c.score < 70 ? 24 : 18, 2, 2, 'F');
        
        // Titre et score
        doc.setTextColor(26, 26, 26);
        doc.setFontSize(9);
        doc.setFont('helvetica', 'bold');
        doc.text(c.pdfName, 22, y + 5);
        
        // Badge priorit√©
        doc.setFillColor(...col);
        doc.roundedRect(pw - 55, y + 1, 25, 6, 2, 2, 'F');
        doc.setTextColor(255, 255, 255);
        doc.setFontSize(6);
        doc.text(priority, pw - 42.5, y + 5, { align: 'center' });
        
        // Score
        doc.setTextColor(...col);
        doc.setFontSize(10);
        doc.setFont('helvetica', 'bold');
        doc.text(c.score + '%', pw - 22, y + 5, { align: 'right' });
        
        // Interpr√©tation
        doc.setTextColor(80, 80, 80);
        doc.setFontSize(7);
        doc.setFont('helvetica', 'normal');
        doc.text(interp, 22, y + 11);
        
        // Solution PT
        if (sol && c.score < 70) {
            doc.setTextColor(0, 150, 130);
            doc.setFontSize(7);
            doc.setFont('helvetica', 'bold');
            doc.text('> Solution Progress Things: ' + sol.pdfName + ' - ' + sol.desc, 22, y + 17);
        }
        
        y += sol && c.score < 70 ? 28 : 22;
    });
    
    // ========== CTA FINAL ==========
    checkPage(35, 'Recommandations');
    y += 5;
    
    doc.setFillColor(0, 212, 170);
    doc.roundedRect(15, y, pw - 30, 30, 5, 5, 'F');
    doc.setTextColor(26, 26, 26);
    doc.setFontSize(11);
    doc.setFont('helvetica', 'bold');
    doc.text('Progress Things peut vous accompagner !', pw / 2, y + 10, { align: 'center' });
    doc.setFontSize(8);
    doc.setFont('helvetica', 'normal');
    doc.text('Support IT Manage - Microsoft 365 - Cybersecurite ESET - Videosurveillance - Formations', pw / 2, y + 17, { align: 'center' });
    doc.setFont('helvetica', 'bold');
    doc.text('www.progressthings.com | technique.bf@progressthings.com | Ouagadougou', pw / 2, y + 24, { align: 'center' });
    
    footer();
    
    // Sauvegarder
    doc.save('DigiPME_' + leadData.companyName.replace(/[^a-zA-Z0-9]/g, '_') + '.pdf');
    showToast('PDF telecharge !', 'success');
}
</script>
</body>
</html>
